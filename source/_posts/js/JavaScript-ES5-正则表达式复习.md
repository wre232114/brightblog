---
title: JavaScript-ES5-正则表达式复习
date: 2020-02-21 16:22:26
tags:
- js
- 正则表达式

category:
- js
- 正则表达式
---
正则表达式是一种描述字符模式的对象。也就是一个正则表达式是描述了一类字符的模式，用一个正则表达式可以来匹配一类字符。

使用正则匹配字符串的时候，从前到后遍历字符串匹配，默认贪婪匹配（即一个模型尽可能多的匹配）。例如，`/0x\d+$/`匹配`0x1234`，`0x`先匹配，正确；然后`\d+`表示一个或者多个数字，`1234`依次匹配成功，到了末尾，匹配`$`，成功。至此模式匹配成功。中间由一个匹配不成功则匹配失败

匹配过程可以用有限自动机来理解。

## 要点
* 直接量字符：所有字符都是按照字面意思进行翻译，除了一些特殊字符。
  * js的正则表达式可以识别转义字符，例如`\t \n \uxxxx`等
  * 具有特殊意义的字符有：`^ $ . * + ? = ! : | \ / ( ) [ ] { }`，如果希望使用这些字符的直接量，使用`\`转义，例如`\.`
* 字符类：匹配某一类字符
  * `[...]`：匹配方括号中任意一个字符，可以使用范围，例如`[a-zA-Z0-9]`
  * `[^...]`：匹配方括号之外的任意一个字符，其他同上
  * `.`：匹配除`\n`和其他Unicode行终止符之外的任意字符
  * `\w`：等价于`[a-zA-Z0-9]`
  * `\W`：等价于`[^a-zA-Z0-9]`
  * `\s`：任何unicode空白符
  * `\S`：任何unicode非空白符
  * `\d`：等价于`[0-9]`
  * `\D`：等价于`[^0-9]`
* 重复：上面是字符模型的定义，要表示多个相同模式的字符呢？可以用`/\d\d\d/`这种形式，但是有更好的方法。**注意，重复默认贪婪匹配，可以通过在后面将上?表示尽可能少的匹配。例如`??`,`+?`**
  * {n,m}：匹配前一项至少n个，至多m个
  * {n,}：匹配前一项n个或者更多
  * {n}：匹配前一项n次
  * ?：匹配1次或者0次，等价于{0,1}
  * +：匹配1个或者更多，等价于{1,}
  * *：匹配0个或者更多，等价于{0,}
* 选择、分组和引用：
  * 选择：`|`，例如`/a|b/`，表示匹配a或者匹配b，即从ab中选择一个匹配
  * 分组：`()`，圆括号有两个作用，第一个是分组，例如`/(ab)+|b/`将(ab)作为一个整体；第二个是定义子模式，`ab`是一个子模式，可以引用该子模式的匹配结果
  * 引用：`\1`，引用的是**用圆括号分组的子模式匹配的文本，例如`/(ab)+|b\1/`其中的`\1`表示引用第一个子模式匹配的文本，如果匹配字符串`ababbb`那么`\1`的值是`abab`
  * **不产生引用的分组**：`(?:...)`，只有分组功能，不记忆匹配结果
* 指定匹配位置：**匹配的是字符串中的位置，而不是具体的字符**
  * 匹配单词边界：`\b`，注意`[\b]`匹配退格
  * 匹配非单词边界：`\B`
  * 匹配开始：`^`，表示匹配一个字符串的开始位置
  * 匹配结束：`$`，表示匹配一个字符串的结束位置
  * 零宽正向先行断言：`(?=p)`，匹配一个位置，该位置的后面是子模式p。例如`/(?=s)/`表示匹配后面是`s`的位置，字符`s`不会被匹配。
  * 零宽负向先行断言：`(?!p)`，同上，不过是匹配后面不满足子模式p的位置。例如`/(?!s)/`表示如果后面不是s则该位置匹配，字符不会被匹配。
* 修饰符：
  * `i`：匹配不区分大小写
  * `g`：执行全局匹配。例如模式`/a+/g`匹配字符串`ababaab`，匹配结果由三个分别是a,a,aa。如果没有g，则只有一个a，因为匹配后不会继续匹配
  * `m`：多行匹配。`^`匹配行开头和字符串开头，`$`匹配行结束和字符串结束。
* 用于模式匹配的String方法
  * s.search(pattern)：在s中匹配pattern，返回第一个批评为位置，没有匹配则返回-1。如果pattern不是正则表达式，则用RegExp变成正则
  * s.replace(pattern|ss, replace)：如果第一个参数是正则，那么替换正则匹配的子串，如果有g则替换所有满足的子串。如果是字符串，那么替换所有等于ss的子串。replace的第二个参数可以是函数，**该函数在每次匹配到子串的时候调用，如果没有g则只调用一次**，函数的形式是`function(fullMatched, child1, child2, ..., position, fullString)`，第一个参数是匹配的子串，后面接所有的括号子模式的匹配结果，然后是匹配的位置和完整字符串，函数的返回值是替换结果。第二个参数还可以是字符串，字符串中可以使用`$1`，`$2`等等来引用括号匹配的子串。
  * s.match(pattern)：如果pattern不是正则，则用RegExp转成正则；如果pattern没有g，则返回一个数组，数组的第一项是匹配结果，后面依次是子模式的匹配结果；如果有g，则返回所有匹配pattern的子串的数组。
  * s.split(pattern)：根据pattern来分割字符串，返回分割后的子串数组。
* 正则表达式的模式匹配方法：
  * pattern.exec(string)：和s.match基本一样
  * pattern.test(string)：根据是否匹配成功返回true或者false，只要string中有子串满足模式就匹配成功。
  