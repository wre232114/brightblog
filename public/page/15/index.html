<!doctype html>
<html lang="de"><head><meta charset="utf-8"><meta name="generator" content="Hexo 4.2.1"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Bright的个人博客</title><meta description="前端开发的技术分享和个人笔记总结"><meta property="og:type" content="blog"><meta property="og:title" content="Bright的个人博客"><meta property="og:url" content="https://www.brightblog.cn/"><meta property="og:site_name" content="Bright的个人博客"><meta property="og:description" content="前端开发的技术分享和个人笔记总结"><meta property="og:image" content="https://www.brightblog.cn/img/og_image.png"><meta property="article:author" content="Bright"><meta property="article:tag" content="前端开发 个人博客"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.brightblog.cn"},"headline":"Bright的个人博客","image":["https://www.brightblog.cn/img/og_image.png"],"author":{"@type":"Person","name":"Bright"},"description":"前端开发的技术分享和个人笔记总结"}</script><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="Bright的个人博客" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-06-17T00:13:51.000Z" title="2019-06-17T00:13:51.000Z">2019-06-17</time><span class="level-item"><a class="link-muted" href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">操作系统</a><span> / </span><a class="link-muted" href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/ucore/">ucore</a></span><span class="level-item">21 minutes read (About 3099 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/06/17/os/ucore_os/ucore-os-lab1%EF%BC%9A%E7%BB%83%E4%B9%A01/">ucore-os实验1：lab1练习1</a></h1><div class="content"><h2 id="练习1：理解通过make生成执行文件的过程"><a href="#练习1：理解通过make生成执行文件的过程" class="headerlink" title="练习1：理解通过make生成执行文件的过程"></a>练习1：理解通过make生成执行文件的过程</h2><p>要求如下：</p>
<ol>
<li>操作系统镜像文件ucore.img是如何一步一步生成的？（需要详细解释Makefile中每一条相关命令和命令参数的含义，以及说明命令参数导致的结果）</li>
<li>一个被系统认为符合规范的硬盘主引导扇区的特征是什么？</li>
</ol>
<p>答：先分析Makefile的整体结构，整个Makefile大概分成下面几个部分（从前到后）：</p>
<ul>
<li>变量定义：定义大量和编译、链接、linux命令、环境变量定义等相关的变量</li>
<li>include：包含了function.mk，function.mk中定义了很多和编译相关的工具函数</li>
<li>函数定义：基于function.mk中的函数再封装了一些函数，用于生成规则并修改前面定义的变量等</li>
<li>规则生成：使用前面定义的函数生成规则，分别生成lib、kernel、bootblock、sign等的规则</li>
<li>ucore.img生成：定义ucore.img生成的规则</li>
<li>通用规则定义：定义了清楚、打分、qemu调试等等规则</li>
</ul>
<p>然后我们从make默认的入口开始——TARGETS。在makefile中有：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">TARGETS: $(TARGETS)</span><br><span class="line">.DEFAULT_GOAL: TARGETS</span><br></pre></td></tr></table></figure><br>上面说明了输入make，找的是TARGETS规则，而TARGETS规则依赖的是变量TARGETS扩展后的值。</p>
<p>然后我们找TARGETS变量，发现TARGETS是一个全局变量，其值在function.mk中定义的函数中改变。当调用<code>create_target</code>时，就会向TARGETS后面添加内容。Makefile中对create_target包装了一层<code>create_target_cc</code>，将最后两个参数设置成CC和CFLAGS。我们看看<code>create_target</code>的实现：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> add packets and objs to target (target, <span class="comment">#packes, #objs[, cc, flags])</span></span></span><br><span class="line">define do_create_target</span><br><span class="line">__temp_target__ = $(call totarget,$(1))</span><br><span class="line">__temp_objs__ = $$(foreach p,$(call packetname,$(2)),$$($$(p))) $(3)</span><br><span class="line">TARGETS += $$(__temp_target__)</span><br><span class="line">ifneq ($(4),)</span><br><span class="line"><span class="meta">$</span><span class="bash">$(__temp_target__): $$(__temp_objs__) | $$$$(dir $$$<span class="variable">$@</span>)</span></span><br><span class="line"><span class="meta">	$</span><span class="bash">(V)$(4) $(5) $$^ -o $<span class="variable">$@</span></span></span><br><span class="line">else</span><br><span class="line"><span class="meta">$</span><span class="bash">$(__temp_target__): $$(__temp_objs__) | $$$$(dir $$$<span class="variable">$@</span>)</span></span><br><span class="line">endif</span><br><span class="line">endef</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> add packets and objs to target (target, <span class="comment">#packes, #objs, cc, [, flags])</span></span></span><br><span class="line">create_target = $(eval $(call do_create_target,$(1),$(2),$(3),$(4),$(5)))</span><br><span class="line"></span><br><span class="line">create_target_host = $(call create_target,$(1),$(2),$(3),$(HOSTCC),$(HOSTCFLAGS))</span><br></pre></td></tr></table></figure>
<p>该函数的作用就是由传进来的参数构建出一个规则。规则生成的方式是：将传进来的target参数扩展成target，packs+objs参数扩展成prerequisites。然后如果有第四个参数，添加编译的recipe，否则使用默认的。</p>
<p>接着我们分析用到了<code>create_target</code>的代码，看看有什么效果，例如：<code>$(call create_target,kernel)</code>。这里只传了target为kernel，那么得到的结果是：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">TARGETS +&#x3D; bin&#x2F;kernel</span><br><span class="line">bin&#x2F;kernel: | bin</span><br></pre></td></tr></table></figure><br>然后我们看到代码中总共有四次使用到了<code>create_target</code>，分别是：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$(call create_target,kernel)</span><br><span class="line">$(call create_target,bootblock)</span><br><span class="line">$(call create_target_host,sign,sign)</span><br><span class="line">$(call create_target,ucore.img)</span><br></pre></td></tr></table></figure><br>根据上面的分析，我们得到运行结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">TARGETS &#x3D; bin&#x2F;kernel bin&#x2F;bootblock bin&#x2F;sign bin&#x2F;ucore.img</span><br><span class="line">bin&#x2F;kernel: | bin</span><br><span class="line">bin&#x2F;bootblock: | bin</span><br><span class="line">bin&#x2F;sign: __objs_sign | bin</span><br><span class="line">  @gcc -g -Wall -O2 __objs_sign -o bin&#x2F;sign</span><br><span class="line">bin&#x2F;ucore.img: | bin</span><br></pre></td></tr></table></figure><br>上面的<code>-g -Wall -O2</code>分别表示输出调试信息，输出警告，采用二级代码优化。-o指定输出的文件名。</p>
<p>所以对于入口<code>TARGETS: $(TARGETS)</code>我们可以得到<code>TARGETS: bin/kernel bin/bootblock bin/sign bin/core.img</code>。接下来我们找kernel和bootblock等为target的规则。</p>
<p>对于kernel，有：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">KOBJS	= $(call read_packet,kernel libs)</span><br><span class="line">kernel = $(call totarget,kernel)</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash">(kernel): tools/kernel.ld</span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash">(kernel): $(KOBJS)</span></span><br><span class="line">	@echo + ld $@</span><br><span class="line"><span class="meta">	$</span><span class="bash">(V)$(LD) $(LDFLAGS) -T tools/kernel.ld -o <span class="variable">$@</span> $(KOBJS)</span></span><br><span class="line"><span class="meta">	@$</span><span class="bash">(OBJDUMP) -S <span class="variable">$@</span> &gt; $(call asmfile,kernel)</span></span><br><span class="line"><span class="meta">	@$</span><span class="bash">(OBJDUMP) -t <span class="variable">$@</span> | $(SED) <span class="string">'1,/SYMBOL TABLE/d; s/ .* / /; /^$$/d'</span> &gt; $(call symfile,kernel)</span></span><br></pre></td></tr></table></figure><br>扩展变量之后的结果是：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">kernel = bin/kernel</span><br><span class="line"></span><br><span class="line">bin/kernel: tools/kernel.ld</span><br><span class="line"></span><br><span class="line">bin/kernel: $(__objs_kernel) $(__objs_libs)</span><br><span class="line">  @echo + ld bin/kernel</span><br><span class="line">  @ld -nostdlib -T tools/kernel.ld -o bin/kernel $(__objs_kernel) $(__objs_libs)</span><br><span class="line">  @objdump -S bin/kernel &gt; kernel.asm</span><br><span class="line">  @objdump -t bin/kernel | sed '1,/SYBOL TABLE/d; s/ .* / /; /^$$/d' &gt; kernel.sym</span><br></pre></td></tr></table></figure><br>通过这里我们知道了kernel的编译规则（这里其实是链接），依赖于<code>$(__objs_kernl)</code>和<code>$(__objs_libs)</code>(待会儿说这个是啥)。recipe中的第一行说明当前链接的文件。第二行指定<code>tools/kernel.ld</code>脚本链接，链接<code>$(__objs_kernel)</code>和<code>$(__objs_lbs)</code>，生成bin/kernel。后面的objdump反编译bin/kernel，提取出汇编代码和符号表中的内容。</p>
<p>接下来我们看看这个<code>__objs_kernel</code>的内容是什么。看function.mk中，第一行就是：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">OBJPREFIX	:&#x3D; __objs_</span><br></pre></td></tr></table></figure><br>然后发现于下面的几个函数有关：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">packetname = $(if $(1),$(addprefix $(OBJPREFIX),$(1)),$(OBJPREFIX))</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> add files to packet: (<span class="comment">#files, cc[, flags, packet, dir])</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> define定义了一个多行变量，作为一个自定义函数。$$是因为<span class="built_in">eval</span>扩展一次，作为make语法解析的时候扩展一次</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果想在作为make解析的时候扩展，使用$$</span></span><br><span class="line">define do_add_files_to_packet</span><br><span class="line">__temp_packet__ := $(call packetname,$(4))</span><br><span class="line">ifeq ($$(origin $$(__temp_packet__)),undefined)</span><br><span class="line"><span class="meta">$</span><span class="bash">$(__temp_packet__) :=</span></span><br><span class="line">endif</span><br><span class="line">__temp_objs__ := $(call toobj,$(1),$(5))</span><br><span class="line"><span class="meta">$</span><span class="bash">$(foreach f,$(1),$$(<span class="built_in">eval</span> $$(call cc_template,$$(f),$(2),$(3),$(5))))</span></span><br><span class="line"><span class="meta">$</span><span class="bash">$(__temp_packet__) += $$(__temp_objs__)</span></span><br><span class="line">endef</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> add objs to packet: (<span class="comment">#objs, packet)</span></span></span><br><span class="line">define do_add_objs_to_packet</span><br><span class="line"><span class="meta">#</span><span class="bash"> __temp_packet值为__objs_$(2)</span></span><br><span class="line">__temp_packet__ := $(call packetname,$(2))</span><br><span class="line">ifeq ($$(origin $$(__temp_packet__)),undefined)</span><br><span class="line"><span class="meta">$</span><span class="bash">$(__temp_packet__) :=</span></span><br><span class="line">endif</span><br><span class="line"><span class="meta">$</span><span class="bash">$(__temp_packet__) += $(1)</span></span><br><span class="line">endef</span><br><span class="line"></span><br><span class="line">add_files_cc = $(call add_files,$(1),$(CC),$(CFLAGS) $(3),$(2),$(4))</span><br></pre></td></tr></table></figure><br>分析代码知道，<code>$(__temp_packet) = __objs_$(4)</code>，<code>__temp_objs</code>值为<code>$(1)</code>将后缀改为<code>.o</code>的文件名。如果是<code>do_add_files_to_packet</code>则还有一个将files编译的过程。</p>
<p>大致知道了<code>__objs_xxx</code>是从哪设置的，接下来具体分析，从Makefile中调用的位置开始：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">(call add_files_cc,$(call listf_cc,$(LIBDIR)),libs,)</span></span><br></pre></td></tr></table></figure><br>会得到（不是最终结果，稍微扩展了一下便于分析）：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">__temp_packet = __objs_libs</span><br><span class="line"></span><br><span class="line">obj/libs/*.d: libs/*.c | obj/libs/</span><br><span class="line">  @cc -Ilibs ...</span><br><span class="line"></span><br><span class="line">obj/libs/*.o: libs/*.c | obj/libs/</span><br><span class="line">  @echo + cc $&lt;</span><br><span class="line">  @cc -I/libs ...</span><br><span class="line"></span><br><span class="line">__objs_libs += obj/libs/*.o</span><br></pre></td></tr></table></figure></p>
<p>这下我们知道<code>__objs_libs</code>的来源及其值了。可以理解了整个项目的构建过程：</p>
<ol>
<li>从<code>TARGET: $(TARGETS)</code>作为入口的rule</li>
<li>TARGETS的值通过<code>create_target</code>函数改变，最后的结果是<code>TARGETS: bin/kernel bin/bootblock bin/sign bin/ucore.img</code>。targets总共有四个依赖</li>
<li>四个依赖分别扩展成：<ul>
<li><code>bin/kernel: __objs_kernel __objs_libs</code>：<code>__objs_kernel</code>和<code>__objs_libs</code>分别是kernel和libs文件夹下c文件编译后得到的.o文件。生成.o文件的规则通过<code>add_files_cc</code>添加。</li>
<li><code>bin/bootblock: obj/boot/*.o | bin/sign</code>：其中，obj/boot/*.o，通过<code>$(foreach f,$(bootfiles),$(call cc_compile,$(f),$(CC),$(CFLAGS) -Os -nostdinc))</code>生成规则。注意<code>bin/bootblock</code>的recipe中只是生成了obj/bootblock.out，在脚本中执行了bin/sign，sign将obj/bootblock.out作为输入，输出了bin/bootblock</li>
<li><code>bin/sign</code>：<code>$(call add_files_host,tools/sign.c,sign,sign)</code>生成如何生成.o文件的规则。<code>$(call create_target_host,sign,sign)</code>生成<code>bin/sign: __objs_sign | bin</code>这里的<code>__objs_sign</code>也是在前面add_files_host的时候设置，其值是sign依赖的.o文件</li>
<li><code>bin/ucore.img</code>：到了最关键的ucore.img的生成了，规则是：<code>$(UCOREIMG): $(kernel) $(bootblock)</code>依赖于上面的kernel和bootblock的结果。其recipe脚本为dd命令，拷贝一个文件并转换格式到目标文件。有三条dd命令，第一条是<code>$(V)dd if=/dev/zero of=$@ count=10000</code>拷贝仅仅10000个block。后面两条使用相同的形式将bootblock拷贝到第一个块，kernel拷贝到后面的块，生成了ucore.img</li>
</ul>
</li>
</ol>
<p>再次总结一下，ucore.img的编译过程是：</p>
<ol>
<li>分别设置bin/kernel、bin/sign、bin/bootblock、bin/ucore.img四个文件的规则。kernel和sign的prerequisites都被设置成临时变量<strong>objs_xxx。生成过程就是就</strong>objs_xxx表示的.o文件链接成可执行文件。</li>
<li>临时变量__objs_xxx和全局变量TARGETS在add_files、add_target等工具函数中设置和改变；add_files函数还有从.c到.o文件的编译规则。</li>
<li>bootblock只生成obj/bootblock.out，在bin/sign脚本执行下才会生成bin/bootblock。所以在bootblock的依赖中添加了bin/target作为前置依赖，保证先生成bin/target。</li>
<li>当kernel和bootblock都生成好了以后在生成ucore.img。ucore.img其实只是将bootblock放在了第一个block，kernel放在了后面的block</li>
</ol>
<p>接下来我们分析编译和链接中的选项的意义。包括从.c到.o以及.o链接成结果中使用的选项。首先是gcc：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">CFLAGS	:= -march=i686 -fno-builtin -fno-PIC -Wall -ggdb -m32 -gstabs -nostdinc $(DEFS)</span><br><span class="line"></span><br><span class="line">CFLAGS	+= $(shell $(CC) -fno-stack-protector -E -x c /dev/null &gt;/dev/null 2&gt;&amp;1 &amp;&amp; echo -fno-stack-protector)</span><br></pre></td></tr></table></figure></p>
<ul>
<li>-march=i686：生成对应i686指令集的机器码</li>
<li>-fno-builtin：不使用内置函数，除非是使用__builtin_开头的函数</li>
<li>-fno-PIC：<strong>跟硬件有关，暂时没有找到其用处</strong></li>
<li>-Wall：输出警告信息</li>
<li>-ggdb：产生用于gdb的调试信息</li>
<li>-m32：生成32位环境下的代码，此时int和long都视为32bit</li>
<li>-gstabs：使用stabs格式产生调试信息，不需要GDB扩展</li>
<li>-nostdinc：不在系统目录中查找header文件，只有-I等指令指定的目录被搜索（<strong>在操作系统开发中不使用标准库，而自己编写适应目标处理器架构的标准库，此时需要这个指令，将对标准库的搜索重定向到自定义的目录</strong>）</li>
<li>-fno-stacl-protector：-fstack-protector的作用是生成额外的代码用于buffer溢出检查。no的意思应该是不生成额外检查的代码。</li>
<li>-I添加头文件检索目录</li>
</ul>
<p>然后是ld：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">LDFLAGS	:= -m $(shell $(LD) -V | grep elf_i386 2&gt;/dev/null | head -n 1) # 结果是elf_i386</span><br><span class="line">LDFLAGS	+= -nostdlib</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash">(V)$(LD) $(LDFLAGS) -T tools/kernel.ld -o <span class="variable">$@</span> $(KOBJS)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash">(V)$(LD) $(LDFLAGS) -N -e start -Ttext 0x7C00 $^ -o $(call toobj,bootblock)</span></span><br></pre></td></tr></table></figure></p>
<ul>
<li>-m elf_i386：仿真仿真链接器</li>
<li>-nostdlib：链接的时候仅仅只搜索命令行指定的目录（因为操作系统不使用标准库）</li>
<li>-T：使用链接脚本，指定的链接脚本将替换默认的链接脚本</li>
<li>-N：将代码段和数据段设置成可读和可写的。同时不将数据段按页对齐，同时仅用共享库的链接。</li>
<li>-e start：将start这个明确的符号作为程序开始执行的入口，而不是使用默认的入口。如果没有名字位start的符号，将会视图将entry翻译成数字，并作为入口地址。</li>
<li>-Ttext：将<code>.bss</code>、<code>.data</code>、<code>.text</code>放到指定的绝对地址，例如0x7C00</li>
</ul>
<p>ucore-os的Makefile还是比较复杂的，定义了很多自定义函数，层层嵌套。而且在没有接触过make等相关gcc编译工具的基础上，更加困难了。但是通过产看make、gcc、ld等工具的文档，一边分析，一边学习。通过一周的努力，终于弄清楚了ucore-os内核和bootloader的编译链接并生成img文件的过程。里程碑！</p>
<p>第二问：<br>分析构建bootblock的sign.c源码：<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;errno.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span></span><br><span class="line">main(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[]) &#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">stat</span> <span class="title">st</span>;</span></span><br><span class="line">    <span class="keyword">if</span> (argc != <span class="number">3</span>) &#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">"Usage: &lt;input filename&gt; &lt;output filename&gt;\n"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (stat(argv[<span class="number">1</span>], &amp;st) != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">"Error opening file '%s': %s\n"</span>, argv[<span class="number">1</span>], strerror(errno));</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"'%s' size: %lld bytes\n"</span>, argv[<span class="number">1</span>], (<span class="keyword">long</span> <span class="keyword">long</span>)st.st_size);</span><br><span class="line">    <span class="keyword">if</span> (st.st_size &gt; <span class="number">510</span>) &#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">"%lld &gt;&gt; 510!!\n"</span>, (<span class="keyword">long</span> <span class="keyword">long</span>)st.st_size);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">char</span> buf[<span class="number">512</span>];</span><br><span class="line">    <span class="built_in">memset</span>(buf, <span class="number">0</span>, <span class="keyword">sizeof</span>(buf));</span><br><span class="line">    FILE *ifp = fopen(argv[<span class="number">1</span>], <span class="string">"rb"</span>);</span><br><span class="line">    <span class="keyword">int</span> <span class="built_in">size</span> = fread(buf, <span class="number">1</span>, st.st_size, ifp);</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">size</span> != st.st_size) &#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">"read '%s' error, size is %d.\n"</span>, argv[<span class="number">1</span>], <span class="built_in">size</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    fclose(ifp);</span><br><span class="line">    buf[<span class="number">510</span>] = <span class="number">0x55</span>;</span><br><span class="line">    buf[<span class="number">511</span>] = <span class="number">0xAA</span>;</span><br><span class="line">    FILE *ofp = fopen(argv[<span class="number">2</span>], <span class="string">"wb+"</span>);</span><br><span class="line">    <span class="built_in">size</span> = fwrite(buf, <span class="number">1</span>, <span class="number">512</span>, ofp);</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">size</span> != <span class="number">512</span>) &#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">"write '%s' error, size is %d.\n"</span>, argv[<span class="number">2</span>], <span class="built_in">size</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    fclose(ofp);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"build 512 bytes boot sector: '%s' success!\n"</span>, argv[<span class="number">2</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>sign.c从main接收两个参数，一个是输入文件名argv[1]，另一个是输出文件名argv[2]。首先从获取argv[1]文件的文件信息，通过struct stat获得。然后输出argv[1]的大小并进行判断。如果size &gt; 510则过大，报错退出。然后从读出argv[1]中的内容，并判断读出的内容的大小是不是和stat中st_size属性值一致。如果不是，报错退出。再把前512个字节中的最后两个字节设置成0x55和0xAA。然后把这512个字节写入到argv[2]。</p>
<p>从上面的流程可以看出，规则是：</p>
<ol>
<li>总大小为512字节</li>
<li>最后两个字节空出来填充0x55和0xAA，bootloader的内容必须小于510字节。</li>
</ol>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-06-16T13:22:12.000Z" title="2019-06-16T13:22:12.000Z">2019-06-16</time><span class="level-item"><a class="link-muted" href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">操作系统</a><span> / </span><a class="link-muted" href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/ucore/">ucore</a></span><span class="level-item">42 minutes read (About 6350 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/06/16/os/ucore_os/ucore-os%E7%AC%94%E8%AE%B02%EF%BC%9AGNU-make/">ucore-os笔记2：GNU make</a></h1><div class="content"><p>c/c++程序基本都是使用GNU make来构建的，其基础是位于根目录的Makefiles文件。</p>
<p>GNU make有什么用呢？我们使用gcc编译器的时候，gcc -o target source，将源文件编译成目标文件，那么如果我们有很多的c/c++文件呢？使用gcc命令就不太合适了。makefiles就是帮我们做这个事情的，它会管理我们要编译的内容，我们指定构建的依赖和构建目标，然后编写对应的构建脚本，完成之后只需要一个make命令，就可以完成构建。make会判断源文件是否被更新过，如果源文件被更新了，那么被更新的那部分会被重新编译。</p>
<p><a href="https://www.gnu.org/software/make/manual/make.html#Overview">GNU Make的官方文档</a>，阅读步骤：阅读每一章的前几个章节，因为前几个章节是介绍性的内容。等到具体到细节的时候，再阅读后面的内容。</p>
<h2 id="概览"><a href="#概览" class="headerlink" title="概览"></a>概览</h2><p>这一部分说明make的使用、makefiles的基本构成、规则、编译脚本、变量等等，先对整体有一个印象，然后我们在后面再深入一些细节。</p>
<h3 id="make的使用"><a href="#make的使用" class="headerlink" title="make的使用"></a>make的使用</h3><p>如果我们在某一个目录下使用make命令，那么会自动区查找该目录下的makefiles或Makefils文件，并执行makefiles文件中的第一个规则（可以通过.MAKEFILE_GOAL变量来修改，后面会说明）。</p>
<h3 id="makefiles的基本构成"><a href="#makefiles的基本构成" class="headerlink" title="makefiles的基本构成"></a>makefiles的基本构成</h3><p>先看一个示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">edit: test.c</span><br><span class="line">  cc -o edit test.c</span><br><span class="line">.PHONY:clean</span><br><span class="line">clean:</span><br><span class="line">	rm -r -f .&#x2F;bin&#x2F;</span><br></pre></td></tr></table></figure></p>
<p>makefile由三个部分组成: target、prerequisites、recipes，对应到上面的实例中就是，edit是target，test.c是prerequisites、下面的脚本是recipes（每一条语句占一行，前面必须有一个tab）。target可以只是命令，而不生成某个输出文件，比如上面的clean。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">target: prerequisites</span><br><span class="line">	...</span><br></pre></td></tr></table></figure>
<p>除此之外，makefiles文件由五个元素组成：显式规则、隐式规则、变量定义、指令（例如include）和注释。</p>
<ul>
<li>显示规则说明了如何重新编译一个或者更多的文件，就是target。</li>
<li>隐式规则说明了合适根据文件的名字来重新构建一类文件。例如target是main.o，那么会自动寻找和编译main.c</li>
<li>变量是将文件赋值给一个变量的一行，稍后使用变量的地方会用该文本代替（类似C中的宏替换）。</li>
<li>指令是在makefiles被解析时告诉make去做一些特殊的事情，包括：<ul>
<li>读取其他makefiles</li>
<li>决定是否使用或者忽略makefiles的一部分（makefiles的条件指令，类似C的预编译条件指令）</li>
<li>从多行字符串定义一个变量</li>
</ul>
</li>
<li>‘#’开头一行，’#’所在行后面的部分都是注释，注意：<ul>
<li>没有被转义的’\’会将注释延续到下一行；这样一个’#’可以实现多行注释</li>
<li>如果要使用符号’#’使用，<code>\#</code></li>
<li>变量和函数调用中不能使用注释，注释会当做纯文本传给变量和函数</li>
<li>recipe中的注释会传给shell</li>
</ul>
</li>
</ul>
<p>include可以导入其他的文件，这个过程时阻塞的，导入其他文件的过程会暂停当前makefiles的解析。</p>
<h3 id="make的运行规则"><a href="#make的运行规则" class="headerlink" title="make的运行规则"></a>make的运行规则</h3><p>当prerequistes被更新时，target会被重新编译。prerequisite有可能也是其他rule的输出，这时候会先更新prerequisites再更新target。make会检测到target所依赖的文件的文件，执行必要的重新编译（未改变的那些不重新编译），在make内部会根据prerequisites来生成依赖图，依据依赖图来决定哪些部分需要重新编译。例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">edit : main.o kbd.o command.o display.o \</span><br><span class="line">       insert.o search.o files.o utils.o</span><br><span class="line">        cc -o edit main.o kbd.o command.o display.o \</span><br><span class="line">                   insert.o search.o files.o utils.o</span><br><span class="line"></span><br><span class="line">main.o : main.c defs.h</span><br><span class="line">        cc -c main.c</span><br><span class="line">kbd.o : kbd.c defs.h command.h</span><br><span class="line">        cc -c kbd.c</span><br><span class="line">command.o : command.c defs.h command.h</span><br><span class="line">        cc -c command.c</span><br><span class="line">display.o : display.c defs.h buffer.h</span><br><span class="line">        cc -c display.c</span><br><span class="line">insert.o : insert.c defs.h buffer.h</span><br><span class="line">        cc -c insert.c</span><br><span class="line">search.o : search.c defs.h buffer.h</span><br><span class="line">        cc -c search.c</span><br><span class="line">files.o : files.c defs.h buffer.h command.h</span><br><span class="line">        cc -c files.c</span><br><span class="line">utils.o : utils.c defs.h</span><br><span class="line">        cc -c utils.c</span><br><span class="line">clean :</span><br><span class="line">        rm edit main.o kbd.o command.o display.o \</span><br><span class="line">           insert.o search.o files.o utils.o</span><br></pre></td></tr></table></figure>
<p>edit依赖于.o文件，每一个.o文件又依赖于对应的.c和.h文件，当执行make的时候，会根据.c文件判断那些.o文件是要重新生成的并重新生成.o文件，然后再生成edit可执行文件。</p>
<p>不是第一条rule或者goal指定的rule所依赖的rule时，该rule不会被执行，例如clean，只能显式使用make clean。</p>
<h3 id="定义变量"><a href="#定义变量" class="headerlink" title="定义变量"></a>定义变量</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">objects &#x3D; main.o kbd.o command.o display.o \</span><br><span class="line">          insert.o search.o files.o utils.o</span><br></pre></td></tr></table></figure>
<p>上面的格式就可以定义变量，可以使用=(递归查找变量的值，意味着可以多层引用变量)，:=(最多只查找一层的变量值，多于的直接当文本处理)，还有其他的定义方式，见变量。</p>
<h3 id="make推断规则"><a href="#make推断规则" class="headerlink" title="make推断规则"></a>make推断规则</h3><p>make有一个隐式的规则：.o文件会自动去找其名字对应的.c文件执行cc命令。也就是说我们可以仅指定.o文件的依赖，不用每条都写对应的cc语句，在prerequisies中也可以不写.c文件，如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">objects &#x3D; main.o kbd.o command.o display.o \</span><br><span class="line">          insert.o search.o files.o utils.o</span><br><span class="line"></span><br><span class="line">edit : $(objects)</span><br><span class="line">        cc -o edit $(objects)</span><br><span class="line"></span><br><span class="line">main.o : defs.h</span><br><span class="line">kbd.o : defs.h command.h</span><br><span class="line">command.o : defs.h command.h</span><br><span class="line">display.o : defs.h buffer.h</span><br><span class="line">insert.o : defs.h buffer.h</span><br><span class="line">search.o : defs.h buffer.h</span><br><span class="line">files.o : defs.h buffer.h command.h</span><br><span class="line">utils.o : defs.h</span><br><span class="line"></span><br><span class="line">.PHONY : clean</span><br><span class="line">clean :</span><br><span class="line">        rm edit $(objects)</span><br></pre></td></tr></table></figure>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>上面是对makefiles的一个小的概括，关键包括下面几点：</p>
<ol>
<li>makefiles是做什么用的？<br>答：makefiles用于自动构建，通过<code>构建目标: 构建依赖\n 构建命令</code>这样的格式来自动构建程序。makefiles会根据我们编写的构建规则来处理构建关系，最后生成构建目标。不仅仅使用于c、c++语言，也适用于其他语言甚至文档。总之，makefiles是一个管理依赖关系的自动构建工具。</li>
<li>makefiles的构建过程？<br>答：输入make之后，会找到第一个规则（如果是make target，则找到target对应的规则），先构建prequistes，例如上例的main.o，先去构建target为main.o的依赖。所有prequistes构建完成后，执行后面的脚本。相当于makefiles先根据我们编写的规则构建依赖树，然后自底向上执行规则的脚本，同时会检测更新确定是否要执行脚本。</li>
</ol>
<h3 id="编译脚本"><a href="#编译脚本" class="headerlink" title="编译脚本"></a>编译脚本</h3><p>recipes会被shell执行所以recipes用shell语法来编写。make不理解shell语法，它仅仅只做一点点简单的处理，然后将其将给shell执行。</p>
<p>make中的recipes规则：</p>
<ul>
<li>以tab开头的空行不是空的，是一条空的recipes</li>
<li>在recipes中的comment不是make的comment，它会被传给shell</li>
<li>在rule中定义，以tab开头的变量不是make变量，它会被传给shell</li>
</ul>
<h2 id="编写makefiles"><a href="#编写makefiles" class="headerlink" title="编写makefiles"></a>编写makefiles</h2><p>上面提到了makefiles包含五个部分，显式规则、隐式规则、变量、指令、注释。接下来会逐步介绍细节。</p>
<h3 id="多行语法"><a href="#多行语法" class="headerlink" title="多行语法"></a>多行语法</h3><p>makefiles使用了一种多行语法，每一个换行符都表示一条语句的结束。通过\可以将单行的内容分布在多行中，非recipe脚本中的\和其前后的空格都会被合并成单个空格。</p>
<blockquote>
<p>指定了<code>.POSIX</code>的target的\不会被压缩。</p>
</blockquote>
<h3 id="Makefile文件的名字"><a href="#Makefile文件的名字" class="headerlink" title="Makefile文件的名字"></a>Makefile文件的名字</h3><p>按照<code>GNUmakefile</code>、<code>makefiles</code>、<code>Makefile</code>的顺序查找。</p>
<p>如果make没有找到上述文件的任何一个，则会启用内置的隐式规则来决定如何构建。</p>
<p>通过make的-f或者–file选项可以指定自己的makefile文件。可以多次使用-f选项，指定的文件按顺序拼接。使用-f会忽略默认的makefile文件。</p>
<h3 id="包括其他makefile文件"><a href="#包括其他makefile文件" class="headerlink" title="包括其他makefile文件"></a>包括其他makefile文件</h3><p><code>include</code>会暂停当前文件的读取转而读取和解析指定的文件，完成后继续本文件。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">include filename</span><br></pre></td></tr></table></figure></p>
<p>例如：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">include *.mk $(bar)</span><br></pre></td></tr></table></figure><br>等价于（假定当前文件夹下有a.mk,b.mk,c.mk。bar的值是bish bash<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">include a.mk b.mk c.mk bish bash</span><br></pre></td></tr></table></figure></p>
<p>如果指定的文件路径下没找到，会去–include-dir选项指定的文件夹下找，以及<code>/usr/local/include</code>、<code>usr/gnu/include</code>、<code>/usr/include</code></p>
<blockquote>
<p>注意：环境变量MAKEFILES用于在文件其他部分解析之前include 变量MAKEFILES指定的一系列文件。类似于include，建议显式使用include而不是MAKEFILES变量。</p>
</blockquote>
<h3 id="没看懂的两节"><a href="#没看懂的两节" class="headerlink" title="没看懂的两节"></a>没看懂的两节</h3><p>How makefiles are remade以及Overriding part of another makefile.</p>
<p>主要是不懂这个部分讲了什么功能，这些功能如何使用以及用于什么场景。</p>
<h3 id="make如何处理Makefile"><a href="#make如何处理Makefile" class="headerlink" title="make如何处理Makefile"></a>make如何处理Makefile</h3><p>GNU make经过两个阶段处理Makefile。第一阶段读取所有makefile，包括included的makefile。内化所有的变量和其值，以及显式和隐式规则，并且构建target和其prerequisites之间的依赖图。</p>
<p>第二阶段利用第一阶段构建的内部结构，决定哪些target需要构建，并且执行其脚本。</p>
<p>理解两阶段构建很重要，因为这涉及到变量和函数何时扩展。先说明基本概念，<code>扩展</code>指变量和函数被替换为相应的值；<code>immediate</code>指第一阶段扩展；<code>deffered</code>指第二阶段扩展。</p>
<h4 id="变量赋值"><a href="#变量赋值" class="headerlink" title="变量赋值"></a>变量赋值</h4><p>变量赋值的解析规则如下，注意前面提到的immediate和deffered的概念。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">immediate &#x3D; deffered</span><br><span class="line">immediate ?&#x3D; deffered</span><br><span class="line">immediate :&#x3D; immediate</span><br><span class="line">immediate ::&#x3D; immediate</span><br><span class="line">immediate +&#x3D; immediate or deffered</span><br><span class="line">immediate !&#x3D; immediate</span><br></pre></td></tr></table></figure>
<h4 id="条件指令"><a href="#条件指令" class="headerlink" title="条件指令"></a>条件指令</h4><p>条件指令是immediate parsed的，在第一阶段就处理了。这意味着，自动化变量不能用于条件指令（因为自动化变量直到rule的recipe调用时才设置）。如果需要使用自动化变量，需要在recipe中使用shell语法的条件指令。</p>
<h4 id="规则定义"><a href="#规则定义" class="headerlink" title="规则定义"></a>规则定义</h4><p>规则定义始终按照如下以下方式处理：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">immediate: immediate; deffered</span><br><span class="line">        deffered</span><br></pre></td></tr></table></figure></p>
<p>target和prerequisites始终时immediate的，而recipe始终时deffered的。</p>
<h3 id="二次扩展"><a href="#二次扩展" class="headerlink" title="二次扩展"></a>二次扩展</h3><p><strong>对于prerequisites</strong>，GNU提供了额外的能力，叫做二次扩展。必须在第一个prerequisites前使用<code>.SECONDEXPANSION</code>来启用这个能力。</p>
<blockquote>
<p>注意：二次扩展仅适用于prerequisites。</p>
</blockquote>
<p>怎么用呢？通过两个$，来实现在正常扩展后的二次扩展，例如：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.SECONDEXPANSION</span><br><span class="line">ONEVAR &#x3D; onefile</span><br><span class="line">TWOVAR &#x3D; twofile</span><br><span class="line">myfile: $(ONEVAR) $$(TWOVAR)</span><br></pre></td></tr></table></figure><br>在第一次扩展以后myfile是<code>myfile: onefile $(TWOVAR)</code>，在二次扩展后，才会变成<code>myfile: onefile twofile</code>。</p>
<p><strong>这里还有其他内容，和自动化变量，显示规则、隐式规则相关，先阅读后面，回来再继续补充。</strong></p>
<h2 id="编写Rule"><a href="#编写Rule" class="headerlink" title="编写Rule"></a>编写Rule</h2><p>rule的顺序不太重要，除了默认的rule——第一个rule。没有指定target的时候，默认找第一个rule。</p>
<h3 id="Rule示例"><a href="#Rule示例" class="headerlink" title="Rule示例"></a>Rule示例</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">foo.o : foo.c defs.h # module for twiddling the frobs</span><br><span class="line">        cc -c -g foo.c</span><br></pre></td></tr></table></figure>
<p>构建target是foo.o，前置要求是foo.c 和defs.h。说明了两个事情：</p>
<ol>
<li>如何决定foo.o是否过期：foo.o不存在或者foo.c 和defs.h更新</li>
<li>如何更新foo.o：执行脚本中的cc命令</li>
</ol>
<h3 id="Rule-语法"><a href="#Rule-语法" class="headerlink" title="Rule 语法"></a>Rule 语法</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">targets : prerequisites</span><br><span class="line">        recipe</span><br><span class="line">        …</span><br><span class="line"><span class="meta">#</span><span class="bash"> or like this:</span></span><br><span class="line"></span><br><span class="line">targets : prerequisites ; recipe</span><br><span class="line">        recipe</span><br><span class="line">        …</span><br></pre></td></tr></table></figure>
<p>要点：</p>
<ul>
<li>targets可以是多个</li>
<li>targets是文件名，可以使用通配符。变量赋值的通配符需要使用通配符函数</li>
<li>recipe是tab开头的行（或者.PRECIPEPREFIX环境变量指定的）</li>
<li><code>$</code>用于变量，如果要使用<code>$</code>符号，使用<code>$$</code>。recipe决定如何更新target，它被传递给shell执行</li>
</ul>
<h3 id="一个target，多个规则"><a href="#一个target，多个规则" class="headerlink" title="一个target，多个规则"></a>一个target，多个规则</h3><p>同一个target可以有多个规则，这些规则会合并成一个规则。这些规则的所有rerequisites会合并成同一个规则。</p>
<p><strong>但是一个target只能有一个recipe</strong>。如果一个target有多个recipe，make会使用最后一个，并给出警告。</p>
<p>使用<code>::</code>可以让一个target拥有多个recipe。target重新构建的时候，每一个recipe都会被独立的执行。</p>
<h2 id="在Rules中编写Recipes"><a href="#在Rules中编写Recipes" class="headerlink" title="在Rules中编写Recipes"></a>在Rules中编写Recipes</h2><p>Recipes包含一条或者多条shell命令，按照出现的次序依次执行。</p>
<h3 id="Recipe语法"><a href="#Recipe语法" class="headerlink" title="Recipe语法"></a>Recipe语法</h3><ul>
<li>tab开头，或者.RECIPEPREFIX变量指定的符号开头，第一条语句可以接在prerequisites后面</li>
<li>recipe中的comment不是make的comment，会传给shell</li>
<li>rule上下文中的变量定义，如果以tab开头，当作shell的变量</li>
<li>条件表达式会传给shell</li>
</ul>
<h4 id="Recipe中使用变量"><a href="#Recipe中使用变量" class="headerlink" title="Recipe中使用变量"></a>Recipe中使用变量</h4><p>recipe中的变量在结束读取makefiles，确定targets过时了之后才会被扩展。</p>
<p>recipe中的变量和函数和makefiles中其他位置有相同的语法和语义，使用上没有区别。</p>
<h3 id="Recipe的执行"><a href="#Recipe的执行" class="headerlink" title="Recipe的执行"></a>Recipe的执行</h3><p>更新target时执行recipes，这些recipe将会在一个新的子shell中执行，除非指定了.ONESHELL。</p>
<h2 id="如何使用变量"><a href="#如何使用变量" class="headerlink" title="如何使用变量"></a>如何使用变量</h2><p>一个变量类似于C语言中的宏替换，其值是一个文本。这些值被替换到targets，prerequisites，recipes以及makefile的其他位置。（变量也叫宏）。</p>
<p>变量名大小写敏感。</p>
<h3 id="变量引用基础"><a href="#变量引用基础" class="headerlink" title="变量引用基础"></a>变量引用基础</h3><p>使用<code>$(var)</code>或者<code>${var}</code>来使用变量。var是变量名。变量可用于targets、prerequisites、recipes、大多数指令以及新的变量。变量被扩展的时候用其值替换。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">objects &#x3D; program.o foo.o utils.o</span><br><span class="line">program : $(objects)</span><br><span class="line">        cc -o program $(objects)</span><br><span class="line">$(objects) : defs.h</span><br></pre></td></tr></table></figure></p>
<h3 id="两种类型的变量"><a href="#两种类型的变量" class="headerlink" title="两种类型的变量"></a>两种类型的变量</h3><p>一种是使用<code>=</code>，表示递归扩展的变量；意思就是，如果扩展后的值还是一个变量，那么会继续对改变量进行扩展。递归扩展在每次扩展时都会对函数进行求值。</p>
<p>另一种是<code>:=</code>，表示简单扩展变量；意思就是，只会扩展一次，值就是扩展后的文本，即便该文本可能是一个变量的扩展（<code>$(two)</code>这种形式）。</p>
<p>还有一种<code>?=</code>，表示条件赋值；意思就是，只有变量没有定义的时候才会定义变量并赋值：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FOO ?&#x3D; bar</span><br></pre></td></tr></table></figure><br>相当于：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ifeq ($(origin FOO), undefined)</span><br><span class="line">        FOO &#x3D; bar #注意是&#x3D;，而不是:&#x3D;</span><br><span class="line">endif</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>注意：变量赋值时会忽略前置的空格，但是后置的空格不会。当涉及到目录的时候，容易出错。例如<code>BINDIR = bin # bin dir</code>，后置空格不会被去除，那么<code>$(BINDIR)/file</code>就会变成<code>bin /file</code>，如果作为命令行参数，<code>bin/file</code>是一个选项，而<code>bin /file</code>就变成两个选项了。</p>
</blockquote>
<h3 id="变量的"><a href="#变量的" class="headerlink" title="变量的+="></a>变量的+=</h3><p>分成两种情况，如果变量已经定义，那么<code>a += b</code>等价于<code>a := $(a) b</code>。</p>
<p>如果变量没有定义，<code>a += b</code>等价于<code>a = b</code></p>
<h3 id="多行变量"><a href="#多行变量" class="headerlink" title="多行变量"></a>多行变量</h3><p>define是另一种定义变量的方式（还有=、:=等等）。语法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">define vari-name[&#x3D;|+&#x3D;|:&#x3D;]</span><br><span class="line">foo</span><br><span class="line">$(bar)</span><br><span class="line">endef</span><br></pre></td></tr></table></figure><br>等于符号可以省略，省略默认使用=。define可以定义多行变量。多行内容的中的变量和函数会正确扩展。里面的make指令也会被正确解析。</p>
<h2 id="makefile中的条件片段"><a href="#makefile中的条件片段" class="headerlink" title="makefile中的条件片段"></a>makefile中的条件片段</h2><p>示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">libs_for_gcc &#x3D; -lgnu</span><br><span class="line">normal_libs &#x3D; </span><br><span class="line"></span><br><span class="line">foo: $(objects)</span><br><span class="line">ifeq ($(CC), gcc)</span><br><span class="line">        $(CC) -o foo $(objects) $(libs_for_gcc)</span><br><span class="line">else</span><br><span class="line">        $(CC) -o foo $(objects) $(normal_libs)</span><br><span class="line">endif</span><br></pre></td></tr></table></figure></p>
<h3 id="条件指令的语法"><a href="#条件指令的语法" class="headerlink" title="条件指令的语法"></a>条件指令的语法</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ifeq(arg1, arg2)</span><br><span class="line">        ...</span><br><span class="line">else</span><br><span class="line">        ...</span><br><span class="line">endif</span><br></pre></td></tr></table></figure>
<p>一共有下面这些条件指令：</p>
<ol>
<li><code>ifeq(arg1, arg2)</code>或者`ifeq “arg1” “arg2”</li>
<li><code>ifdef varname</code></li>
<li><code>ifndef varname</code></li>
</ol>
<h2 id="处理文本的函数"><a href="#处理文本的函数" class="headerlink" title="处理文本的函数"></a>处理文本的函数</h2><p>函数用于处理文本。使用一个函数称为函数调用。通过给函数传一些参数，能够得到函数的返回值。</p>
<h3 id="函数调用语法"><a href="#函数调用语法" class="headerlink" title="函数调用语法"></a>函数调用语法</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$(function arguments)</span><br><span class="line"># 或者</span><br><span class="line">$&#123;function arguments&#125;</span><br></pre></td></tr></table></figure>
<p>通过内置的call函数可以定义自己的函数。</p>
<h3 id="shell函数"><a href="#shell函数" class="headerlink" title="shell函数"></a>shell函数</h3><p>shell函数将参数传给shell命令并且对命令的输出求值。make对参数的处理仅仅是将<code>\</code>替换成空格。</p>
<p>shell函数被扩展的时候执行命令。取决于shell函数的位置，如果在recipe中，则是第二阶段，也就是recipe执行的时候扩展。</p>
<p>示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">files &#x3D; $(shell echo *.c)</span><br></pre></td></tr></table></figure></p>
<h3 id="用于文本替换和分析的函数"><a href="#用于文本替换和分析的函数" class="headerlink" title="用于文本替换和分析的函数"></a>用于文本替换和分析的函数</h3><ol>
<li><p>$(filter pattern…,text)<br>返回text中匹配模式字符串的空格隔开的单词，移除不匹配的单词。可以使用<code>%</code>作为通配符。</p>
<p>示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">source :&#x3D; foo.c bar.c baz.s ugh.h</span><br><span class="line">foo: $(source)</span><br><span class="line">     cc $(filter %.c %.s, $(source)) -o foo</span><br></pre></td></tr></table></figure>
<p>$(filter %.c %.s, $(source))会把source中满足%.c或者%.s的单词取出来。</p>
</li>
<li><p>$(patsubst pattern,replacement,text)<br>找到text中使用空格分开的满足pattern的单词，并用replacement替换他们。可能含有<code>%</code>作为通配符，表示匹配单词中的任意多个字符。如果replacement中出现了<code>%</code>，那么<code>%</code>会使用text中匹配的字符串替换。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(patsubst %.c,%.o,foo.c bar.c)</span><br></pre></td></tr></table></figure>
<p>patsubst还有缩写形式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(var.pattern&#x3D;replacement)</span><br></pre></td></tr></table></figure>
<p>等价于：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(patsubst pattern,replacement,$(var))</span><br></pre></td></tr></table></figure></li>
<li><p>$(sort list)<br>以字符顺序排序list中的单词，移除重复单词。输出是空格隔开的单词序列。<br>例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(sort foo bar lose)</span><br></pre></td></tr></table></figure>
<p>的结果为：<code>bar foo lose</code></p>
<h3 id="条件处理的函数"><a href="#条件处理的函数" class="headerlink" title="条件处理的函数"></a>条件处理的函数</h3><p>有三种提供条件扩展的函数。函数的参数不会在初始化的时候扩展，而只会在需要扩展的时候扩展。</p>
</li>
<li><p>$(if condition,then-part[,else-part])<br>condition的前后空格都会被去掉，然后扩展。如果扩展后的结果是非空字符串，认为是true，如果是空字符串，认为是false。</p>
<p>如果condition为true，那么then-part会被扩展，并将其值作为if函数的值。</p>
<p>如果condition为false，那么else-part会被扩展，并将其值作为if函数的值，如果没有else-part，返回空字符串。</p>
</li>
</ol>
<h3 id="用于文件名的函数"><a href="#用于文件名的函数" class="headerlink" title="用于文件名的函数"></a>用于文件名的函数</h3><ol>
<li>$(addprefix prefix,name…)<br>name是一系列文件名，用空格分割。会将prefix添加到name中的每一个文件名的前面，结果是添加后的空格隔开的字符串。</li>
<li>$(wildcard pattern…)<br>pattern是一个文件名pattern，一般包含通配符。wildcard函数的结果是空格隔开的一系列匹配pattern的文件名。pattern可以是空格隔开的多个规则。</li>
<li>$(basename names…)<br>取出空格隔开的文件名中的除了去掉的值。</li>
<li>$(dir names…)<br>提取names中每一个name的文件夹部分，包括最后的<code>/</code>。当前目录返回<code>./</code>。结果用空格隔开。</li>
</ol>
<h3 id="origin函数"><a href="#origin函数" class="headerlink" title="origin函数"></a>origin函数</h3><p>origin函数说明变量的来源。语法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(origin variable)</span><br></pre></td></tr></table></figure><br>注意这里的variable是变量的名字，不带<code>$</code>。</p>
<p>origin函数可能返回的值：</p>
<ul>
<li>undefined：变量未定义</li>
<li>default：内置的变量</li>
<li>environment：从环境中继承并提供给make的变量</li>
<li>environment override：从环境中继承，但是使用-e选项改写了</li>
<li>file：makefile中定义</li>
<li>command line：命令行中定义</li>
<li>automatic：自动</li>
</ul>
<h3 id="call函数"><a href="#call函数" class="headerlink" title="call函数"></a>call函数</h3><p>call函数可以用于创建新的函数，可以定义一个变量，通过call给该变量传参数将该变量扩展成不同的值。</p>
<p>语法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(call variable,param,param,...)</span><br></pre></td></tr></table></figure><br><code>$(1)</code>，<code>$(2)</code>…用于获取param的值。<code>$(0)</code>是variable。没有最大参数个数也没有最小参数个数。但是参数为0call函数就没有作用了，和普通变量没有区别。variable是变量的名字，没有开头的<code>$</code>，可以但是可以使用变量来扩展成其他变量的名字。</p>
<p>参数在赋值给临时变量前求值。</p>
<h3 id="eval函数"><a href="#eval函数" class="headerlink" title="eval函数"></a>eval函数</h3><p>eval函数通过变量的方式创建新的makefile结构。意思就是，通过eval可以将一个动态的字符串（可以是变量或者函数的值）作为makefile来解析。eval函数的参数会被扩展，扩展的结果用makefile语法解析。扩展的结果中可以定义make变量、target、显式和隐式的规则。</p>
<p>语法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(eval argument)</span><br></pre></td></tr></table></figure><br>eval函数的返回值始终是一个空字符串。</p>
<p>例如：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(foreach prog,$(PROGRAMS),$(eval $(call PROGRAM_template,$(prog))))</span><br></pre></td></tr></table></figure></p>
<p>要注意到eval参数会被扩展两次，第一次作为参数扩展一次。第二次作为make的语法扩展一次。</p>
<h3 id="foreach函数"><a href="#foreach函数" class="headerlink" title="foreach函数"></a>foreach函数</h3><p>语法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(foreach var,list,text)</span><br></pre></td></tr></table></figure><br>第一个参数和第二个参数将在最开始扩展。var扩展后的值是临时变量的名字。list扩展后是一个空格隔开的列表。foreach会遍历list，将其值赋给名字为var扩展后的值的变量。text会在每次遍历的时候扩展，text中一般会引用var。</p>
<p>foreach函数的值是text扩展后通过空格隔开的列表。</p>
<h2 id="9-如何运行make"><a href="#9-如何运行make" class="headerlink" title="9.如何运行make"></a>9.如何运行make</h2><p>一个makefile说明了如何重新编译一个程序。最简单的方式就是重新编译每一个过时的文件。当不带参数执行make的时候是这样的。</p>
<p>但是你也许想只编译一部分文件。可能对于不用的编译器使用不同的编译器选项。通过给make传递特定的选项可以做到这些。</p>
<h3 id="构建目标"><a href="#构建目标" class="headerlink" title="构建目标"></a>构建目标</h3><p>我们前面提到了对于makefiles中的rule，默认使用第一条rule，但是我们也可以通过环境变量或者make选项来设置默认的rule。例如通过<code>.DEFAULT_GOAL</code>变量可以设置默认的rule。</p>
<h2 id="10-使用隐式规则"><a href="#10-使用隐式规则" class="headerlink" title="10.使用隐式规则"></a>10.使用隐式规则</h2><p>隐式规则告诉编译器如果使用常用的技术，可以让你需要使用这些技术的时候不用详细的指定它们。例如将C文件编译成.o文件是一种make常用的场景，make会有相应的隐式规则来将C文件编译成.o文件，例如使用cc命令等等。通过内置的环境变量我们可以控制隐式规则如何工作，比如使用CFLAGS变量改变传给C编译器的flags。</p>
<h3 id="隐式规则使用的变量"><a href="#隐式规则使用的变量" class="headerlink" title="隐式规则使用的变量"></a>隐式规则使用的变量</h3><p>通过内置的一些变量可以设置隐式规则。例如设置编译器选项等等。通过makefile中给变量赋值以及make命令参数可以改变这些变量。</p>
<p>隐式规则使用的变量分成两类：程序的名字（例如CC）以及程序的参数（例如CFLAGS）。</p>
<p>编译C语言程序主要就使用下面几个：</p>
<ul>
<li>CC，编译器命令名</li>
<li>CFLAGS，编译器选项</li>
<li>LDFLAG，链接连接器选项</li>
<li>LDLIBS，链接器链接的库</li>
</ul>
<h3 id="如何使用？"><a href="#如何使用？" class="headerlink" title="如何使用？"></a>如何使用？</h3><p>看一个示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">foo: foo.o bar.o</span><br><span class="line">        cc -o foo.o bar.o $(CFLAGS) $(LDFLAGS)</span><br></pre></td></tr></table></figure><br>这里使用中我们并写没有foo.o的rule，但是make会使用隐式规则自动编译得到foo.o。</p>
<p>make的隐式规则会根据源文件的类型自动选择合适的规则进行处理。</p>
<p>如果不想为一个没有recipe的target使用隐式规则，在recipe中使用<code>;</code>。</p>
<h3 id="定义和重定义模式规则"><a href="#定义和重定义模式规则" class="headerlink" title="定义和重定义模式规则"></a>定义和重定义模式规则</h3><p>模式规则就是在target中有%的规则。一个模式规则可能长这样：<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%.o:%.c; recipe...</span><br></pre></td></tr></table></figure></p>
<h4 id="自动变量"><a href="#自动变量" class="headerlink" title="自动变量"></a>自动变量</h4><p>如果我们要应用模式规则中的文件名怎么办呢？通过自动变量。例如通过<code>$@</code>来使用target文件名，通过<code>@&lt;</code>来使用源文件名。</p>
<p>可用的自动变量如下：</p>
<ul>
<li>$@：target文件名。如果是一个模式匹配的target，那么是触发rule的那一个target</li>
<li>$%：target成员名，当target是一个archive成员的时候</li>
<li>%&lt;：第一个prequisites的名字。如果target从隐式规则获取recipe，那么是隐式规则添加的第一个prerequisites</li>
<li>$?：所有比target新的prerequisites的名字，用空格分开。</li>
<li>$^：所有prerequisites的名字，空格隔开</li>
<li>$|：order-only的prerequisites，空格分开</li>
<li>…</li>
</ul>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://www.gnu.org/software/make/manual/make.html#Overview">GNU make 文档</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-06-16T08:27:49.000Z" title="2019-06-16T08:27:49.000Z">2019-06-16</time><span class="level-item"><a class="link-muted" href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">操作系统</a><span> / </span><a class="link-muted" href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/ucore/">ucore</a></span><span class="level-item">6 minutes read (About 861 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/06/16/os/ucore_os/ucore-os-lab1%EF%BC%9A%E5%AE%89%E8%A3%85%E5%B9%B6%E5%90%AF%E5%8A%A8ucore-os/">ucore-os实验1：安装并启动ucore-os</a></h1><div class="content"><p>我们需要了解很多的预备知识，可以先简略的过一遍基础知识，留个印象，很多东西比较抽象也记不下来，后面用到的时候再回过来看，并进一步查找资料，会有更好的学习效果。</p>
<h2 id="本次实验的预备知识"><a href="#本次实验的预备知识" class="headerlink" title="本次实验的预备知识"></a>本次实验的预备知识</h2><p>实验1的目的是完全掌握操作系统的编译和镜像生成（如何编译和链接）、IO设备访问（硬盘、键盘、显示器等）、内存访问机制、中断机制、BIOS启动、bootloader、实模式和保护模式（内容和如何切换）、elf文件格式等。这些基础知识也是后续实验所需要的基础知识。</p>
<p>主要涉及到的专业课程：</p>
<ul>
<li>计算机接口技术：串行端口、中断控制器、时钟控制器等的访问。</li>
<li>编译技术：GCC编译器的使用、ld链接器的知识、make知识</li>
<li>计算机组成原理：计算机CPU、外设、内存、缓存等之间的关系</li>
<li>数据结构和算法：二分查找、链表等基础知识的运用</li>
<li>编程语言：C语言、汇编语言</li>
</ul>
<p>本实验需要掌握的基础知识：</p>
<ul>
<li><a href="#1">GCC基础和linux命令</a></li>
<li><a href="#3">qemu与GDB调试</a></li>
<li><a href="#4">BIOS和bootloader启动过程</a></li>
<li><a href="#4">elf可执行文件结构</a></li>
<li><a href="#5、7">实模式和保护模式</a></li>
<li><a href="#">串行端口的访问，访问磁盘、显示器、键盘等</a></li>
<li><a href="#">磁盘的基础知识</a></li>
<li><a href="#6">中断机制</a></li>
</ul>
<h2 id="安装实验环境"><a href="#安装实验环境" class="headerlink" title="安装实验环境"></a>安装实验环境</h2><p>以下所有的安装步骤都是在centos 7下进行。其他环境下的安装请参照其他资料。</p>
<h3 id="安装gcc、qemu"><a href="#安装gcc、qemu" class="headerlink" title="安装gcc、qemu"></a>安装gcc、qemu</h3><p>gcc是编译器，qemu是硬件模拟器，通过编译器编译生成.img文件，然后通过qumu硬件模拟器来启动编译后的操作系统。第一次实验的主要目的是：</p>
<ul>
<li>了解gcc编译内核的过程</li>
<li>学习make&amp;makeFile的使用</li>
<li>在qemu上调试内核</li>
<li>了解bootloader的代码</li>
</ul>
<p>在centos 7中，使用yum安装：</p>
<blockquote>
<p>sudo yum install gcc gcc-c++ qemu</p>
</blockquote>
<p>安装完成后在命令行输入qemu，提示无命令，这是因为默认安装的命令是qemu-system-i386，可以创建一个链接文件qemu链接到qemu-system-i386:</p>
<blockquote>
<p>cd /usr/bin</p>
<p>sudo ln -s qemu-system-i386 qemu</p>
</blockquote>
<p>提示：如果编译过程中出现错误，请尝试<a href="#">升级gcc编译器版本</a>。</p>
<h3 id="获取实验代码"><a href="#获取实验代码" class="headerlink" title="获取实验代码"></a>获取实验代码</h3><p>在<a href="https://github.com/chyyuu/ucore_os_lab">这里</a>获取代码，直接git clone下来就ok。</p>
<h3 id="编译-amp-调试内核"><a href="#编译-amp-调试内核" class="headerlink" title="编译&amp;调试内核"></a>编译&amp;调试内核</h3><p>进入到clone下来的项目下的lab1目录下，执行：</p>
<blockquote>
<p>make</p>
</blockquote>
<p>会生成bin文件夹，该文件夹下有.img文件。</p>
<p>下一步我们开始调试内核：</p>
<p>首先我们在qemu中启动内核，注意要使用-S -s操作来暂停cpu执行，因为我们要等待gdb调试程序的接入：</p>
<blockquote>
<p>qemu -s -S -hda ./bin/ucore.img -monitor stdio</p>
</blockquote>
<p>打开另一个命令行窗口：</p>
<blockquote>
<p>target remote:1234<br>break memset<br>continue</p>
</blockquote>
<p>这时候就会暂停在断点位置，使用next，可以继续执行内核代码。如果想进一步了解qemu和gdb的细节，可参阅上面提供的学习笔记。</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-06-15T05:52:24.000Z" title="2019-06-15T05:52:24.000Z">2019-06-15</time><span class="level-item"><a class="link-muted" href="/categories/css/">css</a><span> / </span><a class="link-muted" href="/categories/css/css%E5%9F%BA%E7%A1%80/">css基础</a></span><span class="level-item">17 minutes read (About 2499 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/06/15/css/css%E4%B8%AD%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A1%86%E6%A8%A1%E5%9E%8B/">css中的基本框模型</a></h1><div class="content"><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>这是一篇css基础的文章，主要讲css中的各类框模型的细节，比如inline-block，table，flex，grid。这里会解答一些开发中常见的问题，例如：为什么有时候我设了外边距、内边距没有效果？</p>
<p>这些其实很多都是由css框模型来决定的。那么问题来了：css中的框模型不就是外边距+边框+内边距+内容吗？有什么好说的呢？</p>
<p>其实不然。你知道在什么时候框模型没有外边距、没有内边距吗？为什么表格设了宽度没有效果？事实上，但我们使用display指定不同的布局形式的时候，框模型会根据不同的值，有不同的行为。</p>
<p>同时，也会描述html和css分离的思想，例如，我们知道&lt;div&gt;是块级元素，所有的书上都会这么写，但是其实，只是&lt;div&gt;默认布局是display:block，这是由浏览器实现的默认行为。用这种思想来看待css和html，就会清晰很多。事实上，在浏览器底层，是使用dom+cssdom来构建页面的，cssdom就是由浏览器默认样式、开发者定义的样式等来构建的。html元素的几乎所有样式行为，都可以由css来定制。</p>
<p>当我们理解了上面的两个核心概念——不同框模型的不同行为+html与css分离的思想——之后，我们对于页面的理解/把控一定会更上一层楼。</p>
<h2 id="举个例子"><a href="#举个例子" class="headerlink" title="举个例子"></a>举个例子</h2><p>举个例子，对于表格来说，表格元素(table)和表格单元格(th,td)的框模型其实不一样，表格单元格没有外边距，表格没有内边距（当table-collapse:collapse时，设置内边距没有效果），也就是说在表格单元格设置外边距和表格上设置内边距是无效的。同时，依照html和css分离的思想，表格是display:table，表格单元格是display:table-cell，所以我们在div上使用display:table-cell，可以将div的框模型变成表格单元格，与普通的td并无区别——因为td默认就是display: table-cell。</p>
<p>上一张表格的框模型图：<br><img src="/img/table-layout.png" alt="表格图"><br>在图中我们可以看到，右上角的user agent stylesheet表明是浏览器默认提供的样式表。</p>
<p>我们在设置一下table-cell的margin看看<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">td</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><img src="/img/table-cell.png" alt="表格单元格"><br>可以看到，表格单元格的框模型里面没有margin,只有border,padding和content。</p>
<p>而对于thead,tbody,tr,tfoot呢？thead,tbody,tr,tfoot只有内容和边框，没有内边距和外边距。后面会详细讲表格的细节，包括如何实现表格单元格宽度固定、单行/多行文本、利用css表格属性实现块级/非块级的水平垂直居中对齐等等。</p>
<p>接下来我们列举一些display属性值，来看看其框模型行为究竟是怎样的。</p>
<h2 id="display-block-inline"><a href="#display-block-inline" class="headerlink" title="display:block/inline"></a>display:block/inline</h2><p>这是最常见的两种布局模式，html块级元素的默认布局是block，内联元素的默认布局是inline。相信大家都知道block和inline的区别——block元素单独一行，可以设置宽高；inline元素不能设置宽高，超出一行的内容会自动换行。</p>
<p>如果我们想让一个元素表现得像块级元素，只需设置其display:block，这样设置的元素和div元素没有任何的区别，因为div的默认样式就是display:block。去掉外在，大家都一样，穿上一样的衣服，大家也都一样，这篇文件中会始终使用这个思想（仅仅是个人的理解，不具备任何权威性，大家做个参考就好，欢迎提出批评和指正）</p>
<p>inline和inline-block会继承上级的line-height属性，block每一个block都有自己的line-height属性，当我们要使用line-height进行子元素垂直居中的时候，就需要注意这一点。</p>
<h2 id="display-inline-block"><a href="#display-inline-block" class="headerlink" title="display:inline-block"></a>display:inline-block</h2><p>display:inline-block综合了两种元素的特性，表现的像内联元素，但是它可以设置宽高。</p>
<p>这里需要注意的是，如果我们在一个block元素中写了多个inline-block元素，而我们在源代码中将这几个元素写在了很多行中，那么页面中会多出来间隙，多出来的间隙其实是空格，只不过浏览器将换行、空格等都合并成一个空格了。</p>
<p>这个问题在多个不同行的内联元素中均存在。</p>
<p>如下面的例子：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">span &#123;</span><br><span class="line">  width: 50px;</span><br><span class="line">  height: 40px;</span><br><span class="line">  border: 1px solid gray;</span><br><span class="line">  display: inline-block;</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><br>效果如下图：<br><img src="/img/display-inline-block" alt="效果"></p>
<p>去掉空格可以将父元素的font-size设置成0，然后子元素的字体设置成对应的字体。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">span</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ie8及以上完全支持，在ie6、ie7中不支持，但是可以模拟，在ie6、ie7中，兼容性写法如下：<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">span</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">  *display: inline;</span><br><span class="line">  *<span class="selector-tag">zoom</span>: 1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>*开头是ie特有的，inline说明元素内联显示，zoom触发布局，让其可以设置宽高。</p>
<h2 id="display-table-inline-table"><a href="#display-table-inline-table" class="headerlink" title="display:table/inline-table"></a>display:table/inline-table</h2><p>table和inline-table的区别是，table占单独的一行，而inline-table是内联的，这两者的表格特性都完全相同。inline-table可以用于内联元素的垂直距中对齐。</p>
<p>在前面的示例中我们已经对表格进行了一些介绍，这里稍微总结一下：</p>
<ul>
<li>在表格设置了border-collapse: collapse时，table元素设置padding无效</li>
<li>th、th没有margin，只有padding</li>
<li>thead、tfoot、tbody、tr只有border，没有padding、margin</li>
</ul>
<p>接下来我们更加深入表格，这里我分出来下面几个特性：</p>
<ul>
<li>表格能否设置宽高</li>
<li>表格宽高是否根据内容自动扩张</li>
<li>表格内容换行/不换行</li>
<li>表格内容对齐</li>
</ul>
<h3 id="表格设置宽高"><a href="#表格设置宽高" class="headerlink" title="表格设置宽高"></a>表格设置宽高</h3><p>使用width: VALUE，就可以设置表格的宽。这里需要注意的是，使用<code>table-layout:auto</code>，表格的宽度会随内容的扩展而扩展，不管是否设置了宽高（这时候的宽高相当于min-width、min-height）；使用<code>table-layout:fixed; width:VALUE</code>可以限定表格的宽高，需要注意的是，如果给子元素设置了固定宽高，且子元素的宽度之和大于父元素设置的宽度，那么表格依然会扩展自己的宽度来适应子元素的宽度。</p>
<h3 id="表格宽高根据内容自动扩展"><a href="#表格宽高根据内容自动扩展" class="headerlink" title="表格宽高根据内容自动扩展"></a>表格宽高根据内容自动扩展</h3><p>当table-layout为auto时，表格的宽高会根据内容来自动扩展，即便我们设置了宽高，当内容的宽度大于表格宽度，表格宽度依然会自动扩展，宽度为width的单元格将不显示；</p>
<p>当table-layout为fixed时，需要指定table的width，然后再设置表格单元格的width。这时候表格的宽度就是固定的。但是仍然要注意：</p>
<ul>
<li>所有单元格的内容宽度之和大于表格宽度，表格依然会扩展自己的宽度</li>
<li>所有单元格都设置了宽度，且宽度之和小于表格宽度，那么按照单元格的宽度之比将表格宽度分给单元格。例如：<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">  table &#123;</span><br><span class="line">    table-layout: fixed;</span><br><span class="line">    width: 500px;</span><br><span class="line">  &#125;</span><br><span class="line">  td &#123;</span><br><span class="line">    width: 200px;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="css">  <span class="selector-tag">td</span><span class="selector-pseudo">:first-child</span> &#123;</span></span><br><span class="line">    width: 100px;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>111<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>bright<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure>
那么两个单元格会按照1:2的比例来分这500px。</li>
<li>当只设置了其中某一个或者某几个表格的宽度时，剩下的单元格会平分剩下的空间</li>
<li>高度会始终适应内容的高度，设置height的效果始终只相当于min-height</li>
</ul>
<h3 id="表格换行-不换行"><a href="#表格换行-不换行" class="headerlink" title="表格换行/不换行"></a>表格换行/不换行</h3><p>但表格内的内容是文本时，我们可以利用white-space和word-break属性来控制文本的换行，当没有限定表格单元格的宽度的时候，宽度是根据内容来自适应的，会首先尽量填满表格的空间而不会换行。</p>
<h3 id="表格内容对齐"><a href="#表格内容对齐" class="headerlink" title="表格内容对齐"></a>表格内容对齐</h3><p>可以很方便的利用表格进行垂直居中对齐。</p>
<ul>
<li>块级元素垂直居中对齐：<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css">  <span class="selector-class">.table</span> &#123;</span></span><br><span class="line">    width: 400px;</span><br><span class="line">    height: 400px;</span><br><span class="line">    display: table;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="css">  <span class="selector-class">.table-cell</span> &#123;</span></span><br><span class="line">    width: 100px;</span><br><span class="line">    height: 100px;</span><br><span class="line">    display: table-cell;</span><br><span class="line">    vertical-align: middle;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="css">  <span class="selector-class">.content</span> &#123;</span></span><br><span class="line">    width: 50px;</span><br><span class="line">    height: 50px;</span><br><span class="line">    margin: 0 auto;</span><br><span class="line">    font-size: 14px;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"table"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"table-cell"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"content"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
效果如下：<div style="display:table"><br>  <div style="display:table-cell;width: 100px;height: 100px; border:1px solid gray; vertical-align: middle;"><br>    <div style="width:50px;height:50px;border:1px solid gray;margin: 0 auto"></div><br>  </div><br></div></li>
<li>内联元素和块级类似，块级元素水平居中使用margin:0 auto;，内联元素使用text-align: center;垂直居中使用</li>
</ul>
<h2 id="内联元素、块级元素、匿名元素之间的关系"><a href="#内联元素、块级元素、匿名元素之间的关系" class="headerlink" title="内联元素、块级元素、匿名元素之间的关系"></a>内联元素、块级元素、匿名元素之间的关系</h2><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>接下来对上面提到的一些框模型进行总结，如下表：<br>框模型|特有的css属性|有无内边距|有无外边距|能否设置宽高|备注<br>:—:|:—:|:—:|:—:|:—:|:—:<br>block|/|有|有|可以|利用width可以设置宽度，width:100%可以拉伸，width:auto内容自适应<br>inline|/|有|有|不能|一个块级元素中有多个内联元素，这些内联元素在代码中不在同一行，那么页面中会被插入空格，解决方案看下面<br>inline-block|/|有|有|可以|多行的inline/inline-block会被插入空格，使用font-size可以解决</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-06-11T23:49:20.000Z" title="2019-06-11T23:49:20.000Z">2019-06-12</time><span class="level-item"><a class="link-muted" href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">操作系统</a><span> / </span><a class="link-muted" href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/ucore/">ucore</a></span><span class="level-item">5 minutes read (About 711 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/06/12/os/ucore_os/ucore-os%E7%AC%94%E8%AE%B01%EF%BC%9AGCC%E5%9F%BA%E7%A1%80%E5%92%8Clinux%E5%91%BD%E4%BB%A4/">ucore_os笔记1：GCC基础和linux命令</a></h1><div class="content"><h2 id="GCC的基本用法"><a href="#GCC的基本用法" class="headerlink" title="GCC的基本用法"></a>GCC的基本用法</h2><p>参考这篇博客<a href="/2019/06/11/c%7Cc++/gcc%E7%BC%96%E8%AF%91%E5%99%A8%E5%88%9D%E6%AD%A5/">gcc基础命令</a></p>
<h2 id="GCC内联汇编"><a href="#GCC内联汇编" class="headerlink" title="GCC内联汇编"></a>GCC内联汇编</h2><p>利用gcc提供的内联汇编的特性，我们可以在C语言程序中写汇编代码。gcc内联汇编有两种方式，一种是基本内联汇编语句，另一种是扩展内联汇编语句。</p>
<h3 id="基本内联汇编语句"><a href="#基本内联汇编语句" class="headerlink" title="基本内联汇编语句"></a>基本内联汇编语句</h3><p>例子：<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 基本内联汇编语句，这种方式直接将汇编代码，输出到生成的汇编文件中，可能会影响其他代码</span></span><br><span class="line">  <span class="keyword">asm</span>(<span class="string">".code32\n\t"</span></span><br><span class="line">    <span class="string">"pushl %eax\n\t"</span> <span class="comment">// C语言中相邻的同类型字符串可以拼接</span></span><br><span class="line">  <span class="string">"movl $0, %eax\n\t"</span></span><br><span class="line">  <span class="string">"popl %eax"</span>);</span><br></pre></td></tr></table></figure><br>在asm（或者<strong>asm</strong>，二者含义相同）中直接写汇编代码。</p>
<p>不同的汇编指令之间需要加换行符或者分号。</p>
<h3 id="扩展内联汇编语句"><a href="#扩展内联汇编语句" class="headerlink" title="扩展内联汇编语句"></a>扩展内联汇编语句</h3><p>例子：<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> read_cr0() (&#123; \</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> __dummy; \</span><br><span class="line">  __asm__( \</span><br><span class="line">  <span class="string">"movl %%cr0,%0\n\t"</span> \</span><br><span class="line">  :<span class="string">"=r"</span> (__dummy)); \</span><br><span class="line">  __dummy; \</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><br>GCC扩展内联汇编的基本格式是：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">__asm__ [__volatile__] (</span><br><span class="line">  Assembler Template &#x2F;&#x2F; 汇编模板</span><br><span class="line">  : Output Operands &#x2F;&#x2F; 输出操作数</span><br><span class="line">  [ : Input Operands &#x2F;&#x2F; 输入操作数</span><br><span class="line">  [ : Clobbers ]</span><br><span class="line">  ]</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<ol>
<li><strong>volatile</strong>含义是避免asm指令被删除、移动或者组合，如果不希望被gcc优化而改变位置，需要添加<strong>volatile</strong>关键词。还可以是inline，表示最小化asm代码</li>
<li>接下来的是汇编模板，汇编模板就是添加了占位符的汇编语句，例如<code>movl %%ebp,%0</code>，%0,%1等表示的是汇编模板中的模板变量，通过模板变量可实现汇编语言和C语言的交互。可用的变量数取决于cpu中通用寄存器的个数。汇编变量映射先输出后输入，例%0、%1…是输出操作数部分的变量，后面才是输入操作数部分的变量。</li>
<li>输出操作数部分规定变量如何与寄存器向结合，例如在上例中：”=r”表示%0可以使用任何一个通用寄存器，并且<strong>dummy存放在这个寄存器中，但是如果是：:”=m”(</strong>dummy)，表示操作数存放在内存单元dummy中。</li>
<li>输入部分和输出部分类似，但是没有“=”</li>
</ol>
<p>gcc内联汇编的详细知识可以参考我的另一篇博客<a href="#">gcc内联汇编</a></p>
<h2 id="diff-amp-patch"><a href="#diff-amp-patch" class="headerlink" title="diff &amp; patch"></a>diff &amp; patch</h2><p>diff为linux命令，用于比较文本或文件夹差异；patch命令可以对文件或者文件夹应用修改。</p>
<p>例如是是实验中可能在proj_b中应用前一个实验proj_a中对文件进行的修改，可以使用如下的命令:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">diff -r -u -P proj_a_original proj_a_mine &gt; diff.patch</span><br><span class="line"><span class="built_in">cd</span> proj_b</span><br><span class="line">patch -p1 -u &lt; ../diff.patch</span><br></pre></td></tr></table></figure></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-06-11T14:32:17.000Z" title="2019-06-11T14:32:17.000Z">2019-06-11</time><span class="level-item"><a class="link-muted" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/">编程语言</a><span> / </span><a class="link-muted" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/">C语言</a></span><span class="level-item">10 minutes read (About 1476 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/06/11/c-c++/C%E8%AF%AD%E8%A8%80%E7%BC%96%E7%A8%8B%E9%AD%94%E6%B3%95%E4%B9%A6/1.C%E8%AF%AD%E8%A8%80%E4%B8%AD%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%85%83%E7%B4%A0/">1.C语言中的基本元素</a></h1><div class="content"><p>一个基本C语言程序包含如下几个部分：</p>
<ul>
<li>注释，有单行注释和多行注释。注释部分在预编译处理后就不存在了</li>
<li>预处理器</li>
<li>入口函数main</li>
<li>自定义的函数</li>
</ul>
<p>C语言的头文件用.h结尾，源文件用.c结尾。</p>
<h2 id="C语言中的字符集"><a href="#C语言中的字符集" class="headerlink" title="C语言中的字符集"></a>C语言中的字符集</h2><p>基本上所有语言的字符集都分为两种，一种是<code>源字符集</code>，一种是<code>执行字符集</code>。</p>
<ul>
<li>源字符集：编写代码时候用的字符集</li>
<li>执行字符集：构建完源程序之后的目标二进制文件表示的字符集</li>
</ul>
<p>例如java的源代码文件可能用utf-8编码，但是读入编译器后，使用的是UTF-16，也就是到执行时，一个字符起码占两个字节。</p>
<p>C语言标准允许C语言实现采用多字节字符集。但是是否能够使用多字节字符集进行编码，需要根据编译器的支持程度来看。</p>
<h2 id="C语言中的Token"><a href="#C语言中的Token" class="headerlink" title="C语言中的Token"></a>C语言中的Token</h2><p>token表示词法元素，输入的源文件会被编译器解释成一个个的token，在这些token上再进行语法分析。</p>
<p>C语言标准中定义token和预处理token，分别用于在编译时和预编译时的符号解析。根据预处理的规则，有一些token会在预处理时被处理掉，根据规则来定，所以下面会有重的，字符串可以在预处理中被替换，也可以是字面常量赋值给变量。</p>
<ul>
<li>token：关键词、标识符、常量、字符串字面量和标点符号</li>
<li>预处理token：头文件名、标识符、预处理数、字符常量、字符串字面量、标点符号以及空白符号</li>
</ul>
<h3 id="标识符"><a href="#标识符" class="headerlink" title="标识符"></a>标识符</h3><p>一个标识符由字母、数字、下划线组成，不能由数字开头。（有的C语言实现可以使用多字节字符作为标识符，例如GCC就支持）。C语言标准没有给出标识符的最大长度，但是具体实现上，标识符是64个字符，外部链接是32个字符（来自《C primer》），低版本编译器的实现可能更少。</p>
<h3 id="关键字"><a href="#关键字" class="headerlink" title="关键字"></a>关键字</h3><p>数据类型：int、short、long、signed、unsigned、char、float、double、union、struct、enum、_Bool、_Complex、_Imaginary、void<br>循环控制：while、do、while、for、break、continue<br>分支控制：if、else、switch、case、goto、default、return<br>变量声明：static、const、register、volatile、const、extern、inline、auto、restrict、typedef、_Aalignas、_Atomic、_Noreturn、_Thread_local</p>
<h3 id="C语言中字面量"><a href="#C语言中字面量" class="headerlink" title="C语言中字面量"></a>C语言中字面量</h3><p>四种字面量：</p>
<ul>
<li>整数、浮点数、枚举、字符和字符串字面量</li>
</ul>
<p>例如：1，1.1，’A’，”中文”。</p>
<p>字符串前可以加上u8或者u或者U来使用utf8或者utf16或者utf32编码方式：<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">char</span>* s1 = <span class="string">"hello, world!"</span>; <span class="comment">// 默认编码方式</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span>* s2 = <span class="string">u8"hello, world!"</span>; <span class="comment">// 采用utf-8编码</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span>* s3 = <span class="string">"你好，世界"</span>; </span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span>* s4 = <span class="string">u8"你好，世界"</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span>* s5 = <span class="string">u"你好，世界"</span>; <span class="comment">// 采用utf-16编码，返回unsigned short*</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%s %d\n"</span>, s1, <span class="built_in">strlen</span>(s1)); <span class="comment">// hello world! 13</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%s %d\n"</span>, s2, <span class="built_in">strlen</span>(s2)); <span class="comment">// hello world! 13</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%s %d\n"</span>, s3, <span class="built_in">strlen</span>(s3)); <span class="comment">// 你好，世界 15</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%s %d\n"</span>, s4, <span class="built_in">strlen</span>(s4)); <span class="comment">// 你好，世界 15</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%s %d\n"</span>, s5, <span class="keyword">sizeof</span> s5);  <span class="comment">// 报错，u会转成unsigned short*</span></span><br></pre></td></tr></table></figure><br>gcc编译时，会按照c文件的编码进行编码，因为我们的源文件是utf-8编码，所以里面的中文会按照utf-8编码被gcc处理，所以s3和s4在内存中都是15个字节（大部分utf-8编码的中文都是一个字符占3个字节，示例中5个字符）。都能正常显示中文。如果控制台显示乱码，那么需要查看控制台输出的编码方式，输入locale命令可以查看。</p>
<p>使用u或U会把字符串转成unsigned short数组指针或者unsigned int数组指针，u8会将字符串字面量存储为char*。</p>
<h3 id="C语言中的标点符号"><a href="#C语言中的标点符号" class="headerlink" title="C语言中的标点符号"></a>C语言中的标点符号</h3><p>单目运算符：!、&amp;（用于地址操作符）、*（作为间接操作符）、+（正数符号）、-（负数符号）、～（按位取反）、++、–</p>
<p>双目运算符：</p>
<ul>
<li>算术运算，+、-、*、/、%、=</li>
<li>逻辑运算，&amp;&amp;、||、&lt;、&gt;、==、!=</li>
<li>位运算，&lt;&lt;、&gt;&gt;、 &amp;、|、^</li>
<li>预处理：#、##</li>
<li>组合运算，+=、-=、*=、/=、%=、&lt;&lt;=、&gt;&gt;=、&amp;=、|=、^=</li>
</ul>
<p>三目运算符：?  :，例如a?b:c;</p>
<p>其他符号还有：, [] () . -&gt; {} ; : … &lt;: &lt;% %&gt; %:</p>
<p>不同的操作符的优先级不同，同一个表达式中，优先级高的运算符优先运算，优先级相同的运算符从左到右运算。优先级从高到低：</p>
<ol>
<li>基本表达式：标识符、字面量、圆括号表达式、泛型表达式</li>
<li>后缀操作符：数组下标、函数调用、.和-&gt;、++和–、(int[]){1,2,3}</li>
<li>单目操作符：前缀++和–、&amp;、正负取反等、sizeof、_Alignof等</li>
<li>类型投射</li>
<li>乘除取模</li>
<li>加减</li>
<li>左移右移</li>
<li>关系操作符&lt;、&gt;、&lt;=、&gt;=</li>
<li>==、!=</li>
<li>按位与&amp;</li>
<li>|</li>
<li>按位异或^</li>
<li>&amp;&amp;</li>
<li>||</li>
<li>？:</li>
<li>=</li>
<li>,</li>
</ol>
<p>基本表达式优先级最高，复合表达式第二；单目&gt;双目&gt;三目、算术运算&gt;移位运算&gt;逻辑运算（&lt;、&gt;等）&gt;(==等)&gt;按位运算；</p>
<p>如果不知道优先级关系或者优先级关系复杂，加上圆括号、增强可读性确保不错。因为圆括号优先级属于最高的那一层。</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-06-11T14:16:59.000Z" title="2019-06-11T14:16:59.000Z">2019-06-11</time><span class="level-item"><a class="link-muted" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/">编程语言</a><span> / </span><a class="link-muted" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/">C语言</a></span><span class="level-item">4 minutes read (About 618 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/06/11/c-c++/gcc%E7%BC%96%E8%AF%91%E5%99%A8%E5%88%9D%E6%AD%A5/">gcc编译器初步</a></h1><div class="content"><h2 id="gcc编译器入门"><a href="#gcc编译器入门" class="headerlink" title="gcc编译器入门"></a>gcc编译器入门</h2><p>最近重新复习c/c++，操作系统等等计算机的基础知识，直接从gcc开始，这一篇文章记录gcc编译器命令行的基本使用。</p>
<h2 id="使用gcc编译器编译第一个程序"><a href="#使用gcc编译器编译第一个程序" class="headerlink" title="使用gcc编译器编译第一个程序"></a>使用gcc编译器编译第一个程序</h2><p>编写一个HelloWord.c文件，于目录下运行：</p>
<blockquote>
<p>gcc HelloWorld.c -o HelloWorld.out</p>
</blockquote>
<p>这将在当前目录下生成HelloWorld.out文件，运行./HelloWorld.out执行生成的可执行文件。</p>
<p><i class="blog-notice">注意：在linux系统下，不以后缀区分可执行文件，和windows下不同。.out只是为了区分这是由gcc生成的文件</i></p>
<h2 id="C语言的编译过程"><a href="#C语言的编译过程" class="headerlink" title="C语言的编译过程"></a>C语言的编译过程</h2><p>如下图:<br><img src="/img/compileprocess.jpg" alt="编译过程"></p>
<ol>
<li>预处理，生成.i文件</li>
<li>将.i文件编译成汇编文件，生成.s文件</li>
<li>汇编语言文件经过汇编，生成.o文件</li>
<li>将多个.o文件链接起来生成可执行文件</li>
</ol>
<p>接下来我们看每个步骤对应的编译选项和中间输出结果。<br>选项|作用<br>:—:|:—:<br>-E|预处理<br>-S|生成汇编文件<br>-c|生成.o文件<br>-o|指定输出的文件名<br>-g|生成调试信息</p>
<h3 id="预处理——-E选项"><a href="#预处理——-E选项" class="headerlink" title="预处理—— -E选项"></a>预处理—— -E选项</h3><p>-E选项生成预处理的文件，预处理比如宏命令和包含文件的展开等等。参考<a href="http://c.biancheng.net/view/2375.html">这里</a>，有一些其他的选项，比如如何指定其他的include目录。</p>
<p>我们对上面的HelloWorld.c，执行一下:</p>
<blockquote>
<p>gcc -E HelloWorld.c -o HelloWorld.i</p>
</blockquote>
<p>下面截取了一些代码片段，可以看到将<span class="blog-mask">#include &lt;stdio.h&gt;</span>包含进来了，.i文件中已经包含了stdio中的代码。<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># <span class="number">1</span> <span class="string">"HelloWorld.c"</span></span><br><span class="line"># <span class="number">1</span> <span class="string">"&lt;built-in&gt;"</span></span><br><span class="line"># <span class="number">1</span> <span class="string">"&lt;command-line&gt;"</span></span><br><span class="line"># <span class="number">31</span> <span class="string">"&lt;command-line&gt;"</span></span><br><span class="line"># <span class="number">1</span> <span class="string">"/usr/include/stdc-predef.h"</span> <span class="number">1</span> <span class="number">3</span> <span class="number">4</span></span><br><span class="line"># <span class="number">32</span> <span class="string">"&lt;command-line&gt;"</span> <span class="number">2</span></span><br><span class="line"># <span class="number">1</span> <span class="string">"HelloWorld.c"</span></span><br><span class="line"># <span class="number">1</span> <span class="string">"/usr/include/stdio.h"</span> <span class="number">1</span> <span class="number">3</span> <span class="number">4</span></span><br><span class="line"># <span class="number">27</span> <span class="string">"/usr/include/stdio.h"</span> <span class="number">3</span> <span class="number">4</span></span><br><span class="line"># <span class="number">1</span> <span class="string">"/usr/include/features.h"</span> <span class="number">1</span> <span class="number">3</span> <span class="number">4</span></span><br><span class="line"># <span class="number">375</span> <span class="string">"/usr/include/features.h"</span> <span class="number">3</span> <span class="number">4</span></span><br><span class="line"># <span class="number">1</span> <span class="string">"/usr/include/sys/cdefs.h"</span> <span class="number">1</span> <span class="number">3</span> <span class="number">4</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure></p>
<h3 id="生成汇编语言-S选项"><a href="#生成汇编语言-S选项" class="headerlink" title="生成汇编语言 -S选项"></a>生成汇编语言 -S选项</h3><p>如果想把C语言变量的名称作为汇编语言语句中的注释，可以加上-fverbose-asm选项：</p>
<blockquote>
<p>gcc -S HelloWorld.i -o HelloWorld.s</p>
</blockquote>
<p>HelloWorld.s<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">.file	&quot;HelloWorld.c&quot;</span><br><span class="line">	.text</span><br><span class="line">	.section	.rodata</span><br><span class="line">.LC0:</span><br><span class="line">	.string	&quot;hello world!&quot;</span><br><span class="line">	.text</span><br><span class="line">	.globl	main</span><br><span class="line">	.type	main, @function</span><br><span class="line">main:</span><br><span class="line">.LFB0:</span><br><span class="line">	.cfi_startproc</span><br><span class="line">	pushq	%rbp</span><br><span class="line">	.cfi_def_cfa_offset 16</span><br><span class="line">	.cfi_offset 6, -16</span><br><span class="line">	movq	%rsp, %rbp</span><br><span class="line">...</span><br></pre></td></tr></table></figure></p>
<h3 id="c选项生成没有链接的文件"><a href="#c选项生成没有链接的文件" class="headerlink" title="-c选项生成没有链接的文件"></a>-c选项生成没有链接的文件</h3><p>使用-c选项会为每一个.c文件生成一个.o文件，.o文件链接之后才会生成可执行文件。</p>
<h3 id="编译链接多个文件-amp-生成动态链接库"><a href="#编译链接多个文件-amp-生成动态链接库" class="headerlink" title="编译链接多个文件&amp;生成动态链接库"></a>编译链接多个文件&amp;生成动态链接库</h3></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-06-10T23:50:09.000Z" title="2019-06-10T23:50:09.000Z">2019-06-11</time><span class="level-item"><a class="link-muted" href="/categories/css/">css</a><span> / </span><a class="link-muted" href="/categories/css/less/">less</a></span><span class="level-item">3 minutes read (About 399 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/06/11/css/less/less%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/">less快速入门</a></h1><div class="content"><p>less是一门css预处理语言，添加了变量，mixin，函数等特性，使得css更易维护和扩展。less可以运行于node服务器或者浏览器端。</p>
<p>less完全支持css语法，并在此基础上进行的扩展</p>
<h2 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h2><p>变量以@开头，只能定义一次，实际上就是一个常量，例子：<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@nice-blue:</span> <span class="number">#3242b3</span>;</span><br><span class="line"><span class="variable">@light-blue:</span> <span class="variable">@nice-blue</span>+<span class="number">#111</span>;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#header</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="variable">@light-blue</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="mixin"><a href="#mixin" class="headerlink" title="mixin"></a>mixin</h2><p>minxin其实就是将一个代码片段抽离出来，可以复用，例子：<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.bordered</span> &#123;</span><br><span class="line">  <span class="attribute">border-top</span>: <span class="number">1px</span> solid black;</span><br><span class="line">  <span class="attribute">border-bottom</span>: <span class="number">1px</span> solid black;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>然后要复用这一块代码，只需要将.bordered放到另一个代码块中。<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#menu</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: gray;</span><br><span class="line">  <span class="selector-class">.bordered</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>这里使用class来实现mixin，也可以用id</p>
<h2 id="嵌套规则"><a href="#嵌套规则" class="headerlink" title="嵌套规则"></a>嵌套规则</h2><p>less允许嵌套规则，例子：<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#header</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: black;</span><br><span class="line">  <span class="selector-class">.navigation</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.logo</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>利用嵌套规则可以少写很多代码，同时利用嵌套规则可以得到和html类似的即结构。</p>
<p>类似于sass，可以使用&amp;在嵌套中指代父选择器：<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.parent</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: black;</span><br><span class="line">  <span class="selector-tag">&amp;</span><span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">""</span>;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="嵌套指令和冒泡"><a href="#嵌套指令和冒泡" class="headerlink" title="嵌套指令和冒泡"></a>嵌套指令和冒泡</h2><p>media和keyframes这样的指令可以和选择器一样嵌套。向@media、@supports、@document这样的条件指令会冒泡到最顶层，并将顶层的选择器置于他们之间，例子：<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.screen-color</span> &#123;</span><br><span class="line">  <span class="keyword">@media</span> screen &#123;</span><br><span class="line">    <span class="attribute">color</span>: green;</span><br><span class="line">    <span class="keyword">@media</span> (<span class="attribute">min-width</span>: <span class="number">768px</span>) &#123;</span><br><span class="line">      <span class="attribute">color</span>: red;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">@media</span> tv &#123;</span><br><span class="line">    <span class="attribute">color</span>: black;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>编译后会得到<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@media</span> screen &#123;</span><br><span class="line">  <span class="selector-class">.screen-color</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: green;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">min-width:</span> <span class="number">768px</span>) &#123;</span><br><span class="line">  <span class="selector-class">.screen-color</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: red;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@media</span> tv &#123;</span><br><span class="line">  <span class="selector-class">.screen-color</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: black;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-06-09T09:53:29.000Z" title="2019-06-09T09:53:29.000Z">2019-06-09</time><span class="level-item"><a class="link-muted" href="/categories/hexo/">hexo</a></span><span class="level-item">4 minutes read (About 528 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/06/09/hexo/hexo%E4%B8%AD%E4%BD%BF%E7%94%A8mathjax/">hexo中使用mathjax</a></h1><div class="content"><p>网上给的很多使用hexo插件或者修改各种配置的教程都太过繁琐，而且在我这里不管用，所以我自己上mathjax的官网看了以下，直接使用mathjax，不搞那么多花里胡哨的东西。当然这里方式是通过dom动态实现的，以后我会尝试写个插件在服务器上处理。</p>
<p>当然如果你只是想要在hexo中加入mathjax，而网上找了很多方法都没用，那么这篇文章一定很适合你！</p>
<p>整个教程仅仅只有两步：1.下载mathjax，或者直接使用第三方的cdn；2.将mathjax的script标签添加到ejs文件中。</p>
<h2 id="获取mathjax"><a href="#获取mathjax" class="headerlink" title="获取mathjax"></a>获取mathjax</h2><p>接下来讨论获取mathjax的两种方式：</p>
<h3 id="直接下载源文件"><a href="#直接下载源文件" class="headerlink" title="直接下载源文件"></a>直接下载源文件</h3><p>上<a href="https://docs.mathjax.org/en/latest/installation.html#obtaining-mathjax-via-an-archive">mathjax的官网</a>，找到archive，然后在找到current version，点击下载。</p>
<p>下载解压完成后，文件夹中就已经包含了我们所要的全部信息。如何使用我们稍后再说。</p>
<h3 id="使用cdn"><a href="#使用cdn" class="headerlink" title="使用cdn"></a>使用cdn</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=<span class="string">"text/javascript"</span> src=<span class="string">"https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/latest.js?config=TeX-MML-AM_CHTML"</span>&gt;&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp">&lt;script type="text/</span>x-mathjax-config<span class="string">"&gt;</span></span><br><span class="line"><span class="string">  MathJax.Hub.Config(&#123;tex2jax: &#123;inlineMath: [['$','$'], ['\\(','\\)']]&#125;&#125;);</span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="添加mathjax支持"><a href="#添加mathjax支持" class="headerlink" title="添加mathjax支持"></a>添加mathjax支持</h2><h3 id="使用源文件方式"><a href="#使用源文件方式" class="headerlink" title="使用源文件方式"></a>使用源文件方式</h3><p>使用源文件方式的好处是，对应的静态资源可以放在我们自己的服务器上。</p>
<p>我要要做的仅仅是，将源文件解压后的所有文件拷贝到静态资源服务器下。在hexo中，我们可以放到themes/[你使用的主题]/source/js目录下，<br>然后在ejs文件中，比如layout.ejs，加入下面的代码:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=<span class="string">"text/x-mathjax-config"</span>&gt;</span><br><span class="line">    MathJax.Hub.Config(&#123;</span><br><span class="line">      extensions: [<span class="string">"tex2jax.js"</span>],</span><br><span class="line">      jax: [<span class="string">"input/TeX"</span>,<span class="string">"output/HTML-CSS"</span>],</span><br><span class="line">      tex2jax: &#123;<span class="attr">inlineMath</span>: [[<span class="string">"$"</span>,<span class="string">"$"</span>],[<span class="string">"\\("</span>,<span class="string">"\\)"</span>]]&#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp">    &lt;%- js("js/</span>MathJax<span class="string">") %&gt;</span></span><br></pre></td></tr></table></figure>
<p>也可以直接把这一段代码直接考到你需要的markdown文件中，但是这样每一个md都需要手动添加，比较麻烦。</p>
<h3 id="使用cdn方式"><a href="#使用cdn方式" class="headerlink" title="使用cdn方式"></a>使用cdn方式</h3><p>使用cdn就更容易了，直接把下面的代码粘贴到layouy.ejs中就可以直接使用了：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=<span class="string">"text/javascript"</span> src=<span class="string">"https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/latest.js?config=TeX-MML-AM_CHTML"</span>&gt;&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp">&lt;script type="text/</span>x-mathjax-config<span class="string">"&gt;</span></span><br><span class="line"><span class="string">  MathJax.Hub.Config(&#123;tex2jax: &#123;inlineMath: [['$','$'], ['\\(','\\)']]&#125;&#125;);</span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-06-09T09:07:24.000Z" title="2019-06-09T09:07:24.000Z">2019-06-09</time><span class="level-item"><a class="link-muted" href="/categories/nginx/">nginx</a></span><span class="level-item">a minute read (About 173 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/06/09/nginx/nginx%E5%90%AF%E7%94%A8gzip%E5%92%8C%E7%BC%93%E5%AD%98%E4%BC%98%E5%8C%96/">nginx启用gzip和缓存优化</a></h1><div class="content"><p>这篇文章给出了如何在nginx中配置gzip和开启缓存，利用缓存对网站进行优化。gzip压缩能将文件压缩到原大小的30%。</p>
<h2 id="开启nginx中开启gzip"><a href="#开启nginx中开启gzip" class="headerlink" title="开启nginx中开启gzip"></a>开启nginx中开启gzip</h2><p>直接上配置文件片段：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">http &#123;</span><br><span class="line">  gzip on; # 开启gzip压缩</span><br><span class="line">  gzip_min_length 1k; # 使用gzip的最小文件大小</span><br><span class="line">  gzip_buffers 4 16k; # gzip缓存</span><br><span class="line">  gzip_comp_level 2; # gzip压缩级别，1-10，数字越大效果越好压缩时间越长</span><br><span class="line">  gzip_types text&#x2F;plain application&#x2F;x-javascript text&#x2F;css application&#x2F;xml text&#x2F;javascript application&#x2F;x-httpd-php image&#x2F;jpeg image&#x2F;gif image&#x2F;png application&#x2F;javascript; # 压缩的类型，可以添加</span><br><span class="line">  gzip_disable &quot;MSIE [1-6]\.&quot;;</span><br><span class="line"></span><br><span class="line">  server &#123;</span><br><span class="line">    location &#x2F; &#123;&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="开启缓存"><a href="#开启缓存" class="headerlink" title="开启缓存"></a>开启缓存</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">location ~* \.(?:jpg|jpeg|png|gif|ico|css|js)$ &#123;</span><br><span class="line">  root &#x2F;data;</span><br><span class="line">  expires 60s;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><nav class="pagination is-centered mt-4" role="navigation" aria-label="pagination"><div class="pagination-previous"><a href="/page/14/">Previous</a></div><div class="pagination-next"><a href="/page/16/">Next</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link" href="/">1</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/page/14/">14</a></li><li><a class="pagination-link is-current" href="/page/15/">15</a></li><li><a class="pagination-link" href="/page/16/">16</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/avatar.png" alt="Bright Wu"></figure><p class="title is-size-4 is-block line-height-inherit">Bright Wu</p><p class="is-size-6 is-block">working harder to be better</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Beijing Chaoyang</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">154</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">84</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">115</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/wre232114" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/wre232114"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile is-mobile" href="https://hexo.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li><li><a class="level is-mobile is-mobile" href="https://brightblog.cn" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Bulma</span></span><span class="level-right"><span class="level-item tag">brightblog.cn</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/categories/Java/"><span class="level-start"><span class="level-item">Java</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/Java/spring%E5%AE%9E%E6%88%98/"><span class="level-start"><span class="level-item">spring实战</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/Open-Source/"><span class="level-start"><span class="level-item">Open Source</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/Open-Source/Huaxu/"><span class="level-start"><span class="level-item">Huaxu</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/Webpack/"><span class="level-start"><span class="level-item">Webpack</span></span><span class="level-end"><span class="level-item tag">2</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/Webpack/Webpack%E5%9F%BA%E7%A1%80/"><span class="level-start"><span class="level-item">Webpack基础</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Webpack/Webpack%E5%AE%9E%E6%88%98/"><span class="level-start"><span class="level-item">Webpack实战</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/css/"><span class="level-start"><span class="level-item">css</span></span><span class="level-end"><span class="level-item tag">10</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/css/css%E5%9F%BA%E7%A1%80/"><span class="level-start"><span class="level-item">css基础</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/css/css%E5%B7%A5%E5%85%B7/"><span class="level-start"><span class="level-item">css工具</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/css/less/"><span class="level-start"><span class="level-item">less</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/css/sass/"><span class="level-start"><span class="level-item">sass</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/docker/"><span class="level-start"><span class="level-item">docker</span></span><span class="level-end"><span class="level-item tag">2</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/docker/docker-swarm/"><span class="level-start"><span class="level-item">docker swarm</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/docker/docker%E5%9F%BA%E7%A1%80/"><span class="level-start"><span class="level-item">docker基础</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/git/"><span class="level-start"><span class="level-item">git</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/hexo/"><span class="level-start"><span class="level-item">hexo</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/html5/"><span class="level-start"><span class="level-item">html5</span></span><span class="level-end"><span class="level-item tag">8</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/html5/dom/"><span class="level-start"><span class="level-item">dom</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/html5/html5-API/"><span class="level-start"><span class="level-item">html5 API</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/html5/html5%E6%A0%87%E7%AD%BE%E5%92%8C%E5%B1%9E%E6%80%A7/"><span class="level-start"><span class="level-item">html5标签和属性</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/html5/svg/"><span class="level-start"><span class="level-item">svg</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/html5/tips/"><span class="level-start"><span class="level-item">tips</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/html5/%E5%AE%9E%E6%88%98/"><span class="level-start"><span class="level-item">实战</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/js/"><span class="level-start"><span class="level-item">js</span></span><span class="level-end"><span class="level-item tag">6</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/js/js%E5%9F%BA%E7%A1%80/"><span class="level-start"><span class="level-item">js基础</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/js/typescript/"><span class="level-start"><span class="level-item">typescript</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/js/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/"><span class="level-start"><span class="level-item">正则表达式</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/linux/"><span class="level-start"><span class="level-item">linux</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/linux/%E5%B7%A5%E5%85%B7/"><span class="level-start"><span class="level-item">工具</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/nginx/"><span class="level-start"><span class="level-item">nginx</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/node-js/"><span class="level-start"><span class="level-item">node.js</span></span><span class="level-end"><span class="level-item tag">2</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/node-js/npm/"><span class="level-start"><span class="level-item">npm</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/node-js/%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%B7%A5%E5%85%B7/"><span class="level-start"><span class="level-item">命令行工具</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/php/"><span class="level-start"><span class="level-item">php</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/spring-boot/"><span class="level-start"><span class="level-item">spring-boot</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/spring-boot/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/"><span class="level-start"><span class="level-item">开发工具</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/typescript/"><span class="level-start"><span class="level-item">typescript</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/typescript/%E8%B8%A9%E5%9D%91%E6%8C%87%E5%8D%97/"><span class="level-start"><span class="level-item">踩坑指南</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/vue/"><span class="level-start"><span class="level-item">vue</span></span><span class="level-end"><span class="level-item tag">11</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/vue/cli/"><span class="level-start"><span class="level-item">cli</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/vue/tips/"><span class="level-start"><span class="level-item">tips</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/vue/vue-router/"><span class="level-start"><span class="level-item">vue-router</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/vue/vue%E5%AE%9E%E6%88%98/"><span class="level-start"><span class="level-item">vue实战</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/vue/vue%E7%BB%84%E4%BB%B6%E5%BC%80%E5%8F%91/"><span class="level-start"><span class="level-item">vue组件开发</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/vue/%E5%9F%BA%E7%A1%80/"><span class="level-start"><span class="level-item">基础</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/xml/"><span class="level-start"><span class="level-item">xml</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/xml/%E5%9F%BA%E7%A1%80/"><span class="level-start"><span class="level-item">基础</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/%E5%AD%A6%E4%B9%A0%E6%89%93%E5%8D%A1/"><span class="level-start"><span class="level-item">学习打卡</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E5%AE%89%E5%85%A8/"><span class="level-start"><span class="level-item">安全</span></span><span class="level-end"><span class="level-item tag">3</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/%E5%AE%89%E5%85%A8/%E5%AF%86%E7%A0%81%E6%8A%80%E6%9C%AF/"><span class="level-start"><span class="level-item">密码技术</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"><span class="level-start"><span class="level-item">操作系统</span></span><span class="level-end"><span class="level-item tag">23</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/shell/"><span class="level-start"><span class="level-item">shell</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/ucore/"><span class="level-start"><span class="level-item">ucore</span></span><span class="level-end"><span class="level-item tag">18</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86/"><span class="level-start"><span class="level-item">操作系统原理</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"><span class="level-start"><span class="level-item">数据库</span></span><span class="level-end"><span class="level-item tag">10</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/"><span class="level-start"><span class="level-item">mysql</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/sql%E8%AF%AD%E5%8F%A5/"><span class="level-start"><span class="level-item">sql语句</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/%E5%AF%BC%E8%AE%BA/"><span class="level-start"><span class="level-item">导论</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BC%96%E7%A8%8B/"><span class="level-start"><span class="level-item">数据库编程</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1/"><span class="level-start"><span class="level-item">数据库设计</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"><span class="level-start"><span class="level-item">数据结构</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E5%9B%BE/"><span class="level-start"><span class="level-item">图</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/%E6%A0%91%E8%8E%93%E6%B4%BE/"><span class="level-start"><span class="level-item">树莓派</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E6%AF%95%E8%AE%BE/"><span class="level-start"><span class="level-item">毕设</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E7%AE%97%E6%B3%95/"><span class="level-start"><span class="level-item">算法</span></span><span class="level-end"><span class="level-item tag">20</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/%E7%AE%97%E6%B3%95/leetcode/"><span class="level-start"><span class="level-item">leetcode</span></span><span class="level-end"><span class="level-item tag">18</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E7%AE%97%E6%B3%95/%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8D/"><span class="level-start"><span class="level-item">模式匹配</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E7%AE%97%E6%B3%95/%E6%B7%B1%E5%BA%A6%E4%BC%98%E5%85%88%E6%90%9C%E7%B4%A2/"><span class="level-start"><span class="level-item">深度优先搜索</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"><span class="level-start"><span class="level-item">编程语言</span></span><span class="level-end"><span class="level-item tag">20</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C/"><span class="level-start"><span class="level-item">C</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C/%E8%AF%AD%E8%A8%80/"><span class="level-start"><span class="level-item">语言</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/"><span class="level-start"><span class="level-item">C语言</span></span><span class="level-end"><span class="level-item tag">17</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Java/"><span class="level-start"><span class="level-item">Java</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/java/"><span class="level-start"><span class="level-item">java</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/%E8%8B%B1%E8%AF%AD/"><span class="level-start"><span class="level-item">英语</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/%E8%8B%B1%E8%AF%AD/%E7%94%9F%E8%AF%8D/"><span class="level-start"><span class="level-item">生词</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"><span class="level-start"><span class="level-item">计算机网络</span></span><span class="level-end"><span class="level-item tag">3</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/wireshark/"><span class="level-start"><span class="level-item">wireshark</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95/"><span class="level-start"><span class="level-item">问题记录</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"><span class="level-start"><span class="level-item">设计模式</span></span><span class="level-end"><span class="level-item tag">5</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E4%BA%A4%E7%BB%99%E5%AD%90%E7%B1%BB/"><span class="level-start"><span class="level-item">交给子类</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E7%94%9F%E6%88%90%E5%AE%9E%E4%BE%8B/"><span class="level-start"><span class="level-item">生成实例</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E9%80%82%E5%BA%94%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"><span class="level-start"><span class="level-item">适应设计模式</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2020/06/"><span class="level-start"><span class="level-item">June 2020</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/05/"><span class="level-start"><span class="level-item">May 2020</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/03/"><span class="level-start"><span class="level-item">March 2020</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/02/"><span class="level-start"><span class="level-item">February 2020</span></span><span class="level-end"><span class="level-item tag">18</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/01/"><span class="level-start"><span class="level-item">January 2020</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/12/"><span class="level-start"><span class="level-item">December 2019</span></span><span class="level-end"><span class="level-item tag">16</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/11/"><span class="level-start"><span class="level-item">November 2019</span></span><span class="level-end"><span class="level-item tag">29</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/10/"><span class="level-start"><span class="level-item">October 2019</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/09/"><span class="level-start"><span class="level-item">September 2019</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/08/"><span class="level-start"><span class="level-item">August 2019</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/07/"><span class="level-start"><span class="level-item">July 2019</span></span><span class="level-end"><span class="level-item tag">17</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/06/"><span class="level-start"><span class="level-item">June 2019</span></span><span class="level-end"><span class="level-item tag">18</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/05/"><span class="level-start"><span class="level-item">May 2019</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></div></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><div class="card widget"><div class="card-content"><h3 class="menu-label">Recent</h3><article class="media"><div class="media-content size-small"><p><time dateTime="2020-06-27T13:07:22.000Z">2020-06-27</time></p><p class="title is-6"><a class="link-muted" href="/2020/06/27/%E6%A0%91%E8%8E%93%E6%B4%BE/%E6%A0%91%E8%8E%93%E6%B4%BE3-5%E5%AF%B8%E6%98%BE%E7%A4%BA%E5%99%A8%E5%A5%97%E8%A3%85%E5%AE%89%E8%A3%85%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">树莓派3.5寸显示器套装安装操作系统</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/%E6%A0%91%E8%8E%93%E6%B4%BE/">树莓派</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-06-15T00:21:47.000Z">2020-06-15</time></p><p class="title is-6"><a class="link-muted" href="/2020/06/15/opensource/%E8%B7%A8%E6%A1%86%E6%9E%B6%E3%80%81%E8%87%AA%E5%AE%9A%E4%B9%89%E4%B8%BB%E9%A2%98%E7%9A%84%E9%9D%99%E6%80%81%E5%8D%9A%E5%AE%A2%E7%B3%BB%E7%BB%9F%E5%8E%9F%E5%9E%8B%E6%A6%82%E8%A7%88/">跨框架、自定义主题的静态博客系统原型概览</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/Open-Source/">Open Source</a> / <a class="link-muted" href="/categories/Open-Source/Huaxu/">Huaxu</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-06-15T00:18:37.000Z">2020-06-15</time></p><p class="title is-6"><a class="link-muted" href="/2020/06/15/webpack/webpack%E5%AE%9E%E6%88%98%EF%BC%9A%E6%89%93%E9%80%A0%E5%90%8C%E6%97%B6%E7%BC%96%E8%AF%91react%E5%92%8Cvue%E7%9A%84%E6%9E%84%E5%BB%BA%E5%BC%95%E6%93%8E/">webpack实战：打造同时编译react和vue的构建引擎</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/Webpack/">Webpack</a> / <a class="link-muted" href="/categories/Webpack/Webpack%E5%AE%9E%E6%88%98/">Webpack实战</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-06-14T03:08:34.142Z">2020-06-14</time></p><p class="title is-6"><a class="link-muted" href="/2020/06/14/php/Smarty%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/">Smarty块度入门</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/php/">php</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-06-14T03:08:34.122Z">2020-06-14</time></p><p class="title is-6"><a class="link-muted" href="/2020/06/14/git/%E5%9C%A8centos%E4%B8%8A%E6%90%AD%E5%BB%BAgit%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%93%E5%BA%93/">在centos上搭建git服务器仓库</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/git/">git</a></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/Adapter%E6%A8%A1%E5%BC%8F/"><span class="tag">Adapter模式</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/C%E8%AF%AD%E8%A8%80/"><span class="tag">C语言</span><span class="tag is-grey-lightest">18</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GCC/"><span class="tag">GCC</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Huaxu/"><span class="tag">Huaxu</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Iterator%E6%A8%A1%E5%BC%8F/"><span class="tag">Iterator模式</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Java/"><span class="tag">Java</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%B8%8Eshell%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/"><span class="tag">Linux命令行与shell脚本编程</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Maven/"><span class="tag">Maven</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Open-Source/"><span class="tag">Open Source</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/String/"><span class="tag">String</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Template-Method%E6%A8%A1%E5%BC%8F/"><span class="tag">Template Method模式</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Webpack/"><span class="tag">Webpack</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Webpack%E5%9F%BA%E7%A1%80/"><span class="tag">Webpack基础</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Webpack%E5%AE%9E%E6%88%98/"><span class="tag">Webpack实战</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/autoprefixer/"><span class="tag">autoprefixer</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/browserslist/"><span class="tag">browserslist</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/centos7%E5%B7%A5%E5%85%B7/"><span class="tag">centos7工具</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/css/"><span class="tag">css</span><span class="tag is-grey-lightest">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/css%E5%8D%95%E4%BD%8D/"><span class="tag">css单位</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/css%E5%9F%BA%E7%A1%80/"><span class="tag">css基础</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/css%E5%B7%A5%E5%85%B7/"><span class="tag">css工具</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/css%E5%B8%83%E5%B1%80/"><span class="tag">css布局</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker/"><span class="tag">docker</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker-swarm/"><span class="tag">docker swarm</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker%E5%9F%BA%E7%A1%80/"><span class="tag">docker基础</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/dom/"><span class="tag">dom</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/dom%E5%9F%BA%E7%A1%80/"><span class="tag">dom基础</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/git/"><span class="tag">git</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/hexo/"><span class="tag">hexo</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/html-Permission-API/"><span class="tag">html Permission API</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/html5/"><span class="tag">html5</span><span class="tag is-grey-lightest">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/html5-API/"><span class="tag">html5 API</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/html5%E6%A0%87%E7%AD%BE%E5%92%8C%E5%B1%9E%E6%80%A7/"><span class="tag">html5标签和属性</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/js/"><span class="tag">js</span><span class="tag is-grey-lightest">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/js%E5%9F%BA%E7%A1%80/"><span class="tag">js基础</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/js%E5%AF%B9%E8%B1%A1/"><span class="tag">js对象</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/js%E5%AF%B9%E8%B1%A1%E7%B1%BB%E5%9E%8B%E5%88%A4%E6%96%AD/"><span class="tag">js对象类型判断</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/js%E6%95%B0%E7%BB%84/"><span class="tag">js数组</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/leetcode/"><span class="tag">leetcode</span><span class="tag is-grey-lightest">18</span></a></div><div class="control"><a class="tags has-addons" href="/tags/less/"><span class="tag">less</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/linux%E5%91%BD%E4%BB%A4/"><span class="tag">linux命令</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/linux%E8%BF%9C%E7%A8%8B%E8%BF%9E%E6%8E%A5/"><span class="tag">linux远程连接</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/mysql/"><span class="tag">mysql</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/nginx/"><span class="tag">nginx</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/node-js/"><span class="tag">node.js</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/npm/"><span class="tag">npm</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/postcss/"><span class="tag">postcss</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/spring/"><span class="tag">spring</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/spring-boot/"><span class="tag">spring-boot</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/spring%E5%AE%9E%E6%88%98/"><span class="tag">spring实战</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/sql%E8%AF%AD%E5%8F%A5/"><span class="tag">sql语句</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ssh/"><span class="tag">ssh</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/svg/"><span class="tag">svg</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/svg%E5%9F%BA%E7%A1%80/"><span class="tag">svg基础</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/svg%E5%AE%9A%E4%BD%8D/"><span class="tag">svg定位</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tips/"><span class="tag">tips</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tslint%E5%9F%BA%E7%A1%80/"><span class="tag">tslint基础</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/typescript/"><span class="tag">typescript</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ucore/"><span class="tag">ucore</span><span class="tag is-grey-lightest">18</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ucore-os/"><span class="tag">ucore-os</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/vue/"><span class="tag">vue</span><span class="tag is-grey-lightest">11</span></a></div><div class="control"><a class="tags has-addons" href="/tags/vue-cli/"><span class="tag">vue-cli</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/vue-router/"><span class="tag">vue-router</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/vue-tips/"><span class="tag">vue-tips</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/vue%E5%8D%9A%E5%AE%A2%E5%90%8E%E5%8F%B0%E5%BC%80%E5%8F%91/"><span class="tag">vue博客后台开发</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/vue%E5%9F%BA%E7%A1%80/"><span class="tag">vue基础</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/vue%E5%AE%9E%E6%88%98/"><span class="tag">vue实战</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/vue%E7%BB%84%E4%BB%B6%E5%BC%80%E5%8F%91/"><span class="tag">vue组件开发</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/vue%E8%BF%9B%E9%98%B6/"><span class="tag">vue进阶</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/wireshark/"><span class="tag">wireshark</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/xml/"><span class="tag">xml</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E3%80%8AC-Primer%E3%80%8B/"><span class="tag">《C Primer》</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E3%80%8AC%E8%AF%AD%E8%A8%80%E7%BC%96%E7%A8%8B%E9%AD%94%E6%B3%95%E4%B9%A6%E3%80%8B/"><span class="tag">《C语言编程魔法书》</span><span class="tag is-grey-lightest">12</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E3%80%8ALinux%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%92%8CShell%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B%E3%80%8B/"><span class="tag">《Linux命令行和Shell脚本编程》</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E3%80%8A%E5%9B%BE%E8%A7%A3%E5%AF%86%E7%A0%81%E6%8A%80%E6%9C%AF%E3%80%8B/"><span class="tag">《图解密码技术》</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BA%8C%E5%8F%89%E6%A0%91/"><span class="tag">二叉树</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BA%A4%E7%BB%99%E5%AD%90%E7%B1%BB/"><span class="tag">交给子类</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%88%86%E6%B2%BB/"><span class="tag">分治</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"><span class="tag">动态规划</span><span class="tag is-grey-lightest">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8D%95%E8%AF%8D/"><span class="tag">单词</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%B7%A5%E5%85%B7/"><span class="tag">命令行工具</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%9B%BE/"><span class="tag">图</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%9F%BA%E7%A1%80/"><span class="tag">基础</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AE%89%E5%85%A8/"><span class="tag">安全</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AE%9E%E6%88%98/"><span class="tag">实战</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AF%86%E7%A0%81%E6%8A%80%E6%9C%AF/"><span class="tag">密码技术</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AF%BC%E8%AE%BA/"><span class="tag">导论</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/"><span class="tag">开发工具</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B/"><span class="tag">异步编程</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"><span class="tag">操作系统</span><span class="tag is-grey-lightest">22</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86/"><span class="tag">操作系统原理</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%95%B0%E5%AD%A6/"><span class="tag">数学</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"><span class="tag">数据库</span><span class="tag is-grey-lightest">10</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BC%96%E7%A8%8B/"><span class="tag">数据库编程</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1/"><span class="tag">数据库设计</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"><span class="tag">数据结构</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%95%B0%E7%BB%84/"><span class="tag">数组</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%9D%83%E9%99%90/"><span class="tag">权限</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%A0%91%E8%8E%93%E6%B4%BE/"><span class="tag">树莓派</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8D/"><span class="tag">模式匹配</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/"><span class="tag">正则表达式</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%AF%95%E8%AE%BE/"><span class="tag">毕设</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%B7%B1%E5%BA%A6%E4%BC%98%E5%85%88%E6%90%9C%E7%B4%A2/"><span class="tag">深度优先搜索</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%94%9F%E6%88%90%E5%AE%9E%E4%BE%8B/"><span class="tag">生成实例</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%AE%97%E6%B3%95/"><span class="tag">算法</span><span class="tag is-grey-lightest">20</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"><span class="tag">编程语言</span><span class="tag is-grey-lightest">20</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%8B%B1%E8%AF%AD/"><span class="tag">英语</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"><span class="tag">计算机网络</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"><span class="tag">设计模式</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"><span class="tag">读书笔记</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%B8%A9%E5%9D%91%E6%8C%87%E5%8D%97/"><span class="tag">踩坑指南</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%80%82%E5%BA%94%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"><span class="tag">适应设计模式</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%93%BE%E8%A1%A8/"><span class="tag">链表</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95/"><span class="tag">问题记录</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%AB%98%E6%95%B01/"><span class="tag">高数1</span><span class="tag is-grey-lightest">1</span></a></div></div></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe to Updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button is-primary" type="submit" value="Subscribe"></div></div></form></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="Bright的个人博客" height="28"></a><p class="size-small"><span>&copy; 2020 Bright</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script>moment.locale("default");</script><script>var IcarusThemeSettings = {
            site: {
                url: 'https://www.brightblog.cn',
                external_link: {"enable":true,"exclude":[]}
            },
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to Top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>